{"version":3,"file":"events.min.js","sources":["../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/promises.js","../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/math.js","../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/trust.js","../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/utility.js","../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/events.js","../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/abort.js","../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/types.js","../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/attrs.js","../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/dom.js","../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/HTTPException.js","../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/http.js","../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/krv/events.js","../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/custom-elements.js","../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/elements.js","../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/loader.js","../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/google-analytics.js","../consts.js","../import.meta.js","../https:/unpkg.com/@shgysk8zer0/kazoo@0.0.8/intersect.js","events.js"],"sourcesContent":["/**\n * @copyright 2023 Chris Zuber <admin@kernvalley.us>\n */\nimport { signalAborted } from './abort.js';\nexport const infinitPromise = new Promise(() => {});\n\nexport async function locksSupported() {\n\tif ('locks' in navigator) {\n\t\ttry {\n\t\t\treturn await navigator.locks.request('lock-test', () => true);\n\t\t} catch(err) {\n\t\t\treturn false;\n\t\t}\n\t}\n}\n\nexport function isAsyncFunction(what) {\n\treturn what instanceof Function && what.constructor.name === 'AsyncFunction';\n}\n\nexport function isAsync(what) {\n\treturn isAsyncFunction(what) || what instanceof  Promise;\n}\n\nexport function getDeferred({ signal } = {}) {\n\tconst deferred = {};\n\n\tdeferred.promise = new Promise((resolve, reject) => {\n\t\tdeferred.resolve = resolve;\n\t\tdeferred.reject = reject;\n\t});\n\n\tif (signal instanceof EventTarget && signal.throwIfAborted instanceof Function) {\n\t\tif (signal.aborted) {\n\t\t\tdeferred.reject(signal.reason);\n\t\t} else {\n\t\t\tsignal.addEventListener('abort', ({ target }) => deferred.reject(target.reason), { once: true });\n\t\t}\n\t}\n\n\treturn Object.seal(deferred);\n}\n\nexport async function callAsAsync(callback, args = [], { thisArg = globalThis, signal } = {}) {\n\tconst { promise, resolve, reject } = getDeferred({ signal });\n\n\tif (! (callback instanceof Function)) {\n\t\treject(new TypeError('`callAsAsync` expects callback to be a function'));\n\t} else if (! Array.isArray(args)) {\n\t\treject(new TypeError('`args` must be an array'));\n\t} else if (signal instanceof AbortSignal && signal.aborted) {\n\t\treject(signal.reason);\n\t} else if (isAsyncFunction(callback)) {\n\t\tcallback.call(thisArg, args).then(resolve).catch(reject);\n\t} else {\n\t\tqueueMicrotask(() => {\n\t\t\ttry {\n\t\t\t\tresolve(callback.call(thisArg, args));\n\t\t\t} catch(err) {\n\t\t\t\treject(err);\n\t\t\t}\n\t\t});\n\t}\n\n\treturn await promise;\n}\n\nexport function createDeferredCallback(callback, { signal, thisArg } = {}) {\n\tconst { promise, resolve } = getDeferred({ signal });\n\tconst retPromise = promise.then(() => callAsAsync(callback, [], { signal, thisArg }));\n\n\treturn async () => {\n\t\tresolve();\n\t\treturn await retPromise;\n\t};\n}\n\nexport async function lock(name, callback, {\n\tthisArg = globalThis,\n\targs = [],\n\tmode = 'exclusive',\n\tifAvailable = false,\n\tsteal = false,\n\tallowFallback = true,\n\tsignal,\n} = {}) {\n\tif ((! allowFallback) || await locksSupported()) {\n\t\treturn await navigator.locks.request(name, { mode, ifAvailable, steal, signal }, async lock => {\n\t\t\tif (lock) {\n\t\t\t\treturn await callAsAsync(callback, [lock, ...args], { thisArg, signal });\n\t\t\t}\n\t\t});\n\t} else {\n\t\treturn await callAsAsync(callback, [null, ...args], { signal, thisArg });\n\t}\n}\n\nexport async function onAnimationFrame(callback, {\n\tthisArg = globalThis,\n\targs = [],\n\tsignal,\n} = {}) {\n\tconst { promise, resolve, reject } = getDeferred({ signal });\n\tconst id = requestAnimationFrame(hrts => callAsAsync(callback, [hrts, ...args], { signal, thisArg }).then(resolve, reject));\n\n\tif (signal instanceof AbortSignal) {\n\t\tsignalAborted(signal).finally(() => cancelAnimationFrame(id));\n\t}\n\n\treturn await promise;\n}\n\nexport async function onIdle(callback, {\n\ttimeout,\n\tthisArg = globalThis,\n\targs = [],\n\tsignal,\n} = {}) {\n\tconst { promise, resolve, reject } = getDeferred({ signal });\n\tconst id = requestIdleCallback(hrts => callAsAsync(callback, [hrts, ...args], { thisArg, signal }).then(resolve, reject), { timeout });\n\n\tif (signal instanceof AbortSignal) {\n\t\tsignalAborted(signal).finally(() => cancelIdleCallback(id));\n\t}\n\n\treturn await promise;\n}\n\nexport async function onTimeout(callback, {\n\ttimeout = 0,\n\tthisArg = globalThis,\n\targs = [],\n\tsignal,\n} = {}) {\n\tconst { resolve, reject, promise } = getDeferred({ signal });\n\n\tif (Number.isSafeInteger(timeout) && timeout >= 0) {\n\t\tconst id = setTimeout(() => {\n\t\t\tcallAsAsync(callback, args, { signal, thisArg }).then(resolve).catch(reject);\n\t\t}, timeout);\n\n\t\tif (signal instanceof AbortSignal) {\n\t\t\tsignalAborted(signal).finally(() => clearTimeout(id));\n\t\t}\n\t} else {\n\t\treject(new TypeError('`timeout` must be a positive intege'));\n\t}\n\n\treturn await promise;\n}\n\nexport async function sleep(timeout, { signal } = {}) {\n\tconst { resolve, promise } = getDeferred({ signal });\n\tonTimeout(() => resolve(performance.now()), { signal, timeout })\n\t\t.catch(() => resolve(performance.now()));\n\treturn await promise;\n}\n","/**\n * @copyright 2023 Chris Zuber <admin@kernvalley.us>\n */\nexport const isNumber = num => typeof num === 'number' && ! Number.isNaN(num);\n\nexport const divisibleBy = (num, divisor) => isNumber(num) && num % divisor === 0;\n\nexport const even = num => divisibleBy(num, 2);\n\nexport const odd = num => ! even(num);\n\nexport const between = (min, val, max) => isNumber(val) && val >= min && val <= max;\n\nexport const clamp = (min, value, max) => Math.min(max, Math.max(min, value));\n\nexport const uint8 = n => Math.min(0, parseInt(n) % 255);\n\nexport const uint8clamped = n => clamp(0, parseInt(n), 255);\n\nexport const toHex = val => uint8clamped(val).toString(16).padStart(2, '0');\n\nconst supportsRange = () => 'Iterator' in globalThis && (globalThis.Iterator.range instanceof Function);\n\n/**\n * @deprecated\n */\nexport function range(start, end, step = 1) {\n\tconsole.warn('range() is deprecated. Use `Iterator.range()` instead.');\n\tif (supportsRange()) {\n\t\treturn Iterator.range(start, end, { step });\n\t} else {\n\t\tthrow new DOMException('`Iterator.range()` not supported.');\n\t}\n}\n\n/**\n * Note: Requires iterator helper methods & `Iterator.range()`\n */\nexport function isPrime(n) {\n\tif (! supportsRange()) {\n\t\tthrow new DOMException('`Iterator.range()` not supported.');\n\t} else if (! Number.isSafeInteger(n) || n < 2) {\n\t\treturn false;\n\t} else if (n === 2 || n === 3 || n === 5 || n === 7) {\n\t\treturn true;\n\t} else if (n % 2 === 0) {\n\t\treturn false;\n\t} else {\n\t\tconst sqrtAndOne = Math.floor(Math.sqrt(n)) + 1;\n\t\treturn ! Iterator.range(3, sqrtAndOne, { step: 2 }).some(f => n % f === 0);\n\t}\n}\n\n/**\n * Note: Requires iterator helper methods & `Iterator.range()`\n */\nexport const primes = (start = 2, end = Infinity) => Iterator.range(start, end).filter(isPrime);\n\nexport function* fibonacci(terms = Number.MAX_SAFE_INTEGER) {\n\tif (! (Number.isSafeInteger(terms) && terms > 0)) {\n\t\tthrow new TypeError('Invalid terms given');\n\t}\n\n\tlet current = 1, prev = 1;\n\tyield 1;\n\n\tfor (let term = 1; term < terms; term++) {\n\t\tyield current;\n\t\t[prev, current] = [current, current + prev];\n\t}\n}\n\nexport function randomFloat(min, max) {\n\t[min, max] = [Math.min(min, max), Math.max(min, max)];\n\treturn Math.random() * (max - min + 1) + min;\n}\n\nexport function randomInt() {\n\treturn crypto.getRandomValues(new Uint32Array(1))[0];\n}\n\nexport function* rng({ length = 32 } = {}) {\n\twhile(true) {\n\t\tfor (const num of crypto.getRandomValues(new Uint8Array(length))) {\n\t\t\tyield num;\n\t\t}\n\t}\n}\n\nexport function* rng16({ length = 32 } = {}) {\n\twhile(true) {\n\t\tfor (const num of crypto.getRandomValues(new Uint16Array(length))) {\n\t\t\tyield num;\n\t\t}\n\t}\n}\n\nexport function* rng32({ length = 32 } = {}) {\n\twhile(true) {\n\t\tfor (const num of crypto.getRandomValues(new Uint32Array(length))) {\n\t\t\tyield num;\n\t\t}\n\t}\n}\n\nexport function sigma(start, end, callback) {\n\treturn Iterator.range(start, end).map(callback).reduce((sum, n) => sum + n);\n}\n\nexport function sum(...nums) {\n\treturn nums.reduce((sum, num) => sum + num);\n}\n\nexport function product(...nums) {\n\treturn nums.reduce((prod, num) => prod * num);\n}\n\nexport function mean(...nums) {\n\treturn sum(...nums) / nums.length;\n}\n\nexport function variance(...nums) {\n\tif (nums.length <= 1) {\n\t\treturn 0;\n\t}\n\tconst m = mean(...nums);\n\treturn nums.reduce((sum, num) => sum + (num - m)**2, 0) / (nums.length - 1);\n}\n\nexport function standardDeviation(...nums) {\n\treturn Math.sqrt(variance(...nums));\n}\n\nexport function choose(n, k) {\n\tif (k === 0 || k === n) {\n\t\treturn 1;\n\t} else if (! (Number.isInteger(n) && Number.isInteger(k))) {\n\t\treturn NaN;\n\t}\n\treturn factorial(n) / (k * factorial(n - k));\n}\n\nexport function factorial(n) {\n\tif (! Number.isInteger(n)) {\n\t\treturn NaN;\n\t} else if (n > 1) {\n\t\treturn n * factorial(n - 1);\n\t} else if (n === 1 || n === 0) {\n\t\treturn 1;\n\t} else {\n\t\treturn undefined;\n\t}\n}\n","/**\n * @copyright 2023 Chris Zuber <admin@kernvalley.us>\n */\nimport { callOnce } from './utility.js';\n\nexport function setProp(el, prop, val, {\n\tpolicy,\n} = {}) {\n\tswitch(getPropertyType(el.tagName, prop)) {\n\t\tcase 'TrustedScript':\n\t\t\tel[prop] = createScript(val, { policy });\n\t\t\tbreak;\n\n\t\tcase 'TrustedScriptURL':\n\t\t\tel[prop] = createScriptURL(val, { policy });\n\t\t\tbreak;\n\n\t\tcase 'TrustedHTML':\n\t\t\tel[prop] = createHTML(val, { policy });\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tel[prop] = val;\n\t}\n}\n\nexport function setAttr(el, attr, val, {\n\telementNs,\n\tpolicy,\n} = {}) {\n\tswitch(getAttributeType(el.tagName, attr, elementNs)) {\n\t\tcase 'TrustedScriptURL':\n\t\t\tif (typeof elementNs === 'string') {\n\t\t\t\tel.setAttributeNs(elementNs, attr, createScriptURL(val, { policy }));\n\t\t\t} else {\n\t\t\t\tel.setAttribute(attr, createScriptURL(val, { policy }));\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'TrustedScript':\n\t\t\tif (typeof elementNs === 'string') {\n\t\t\t\tel.setAttributeNS(elementNs, attr, createScript(val, { policy }));\n\t\t\t} else {\n\t\t\t\tel.setAttribute(attr, createScript(val, { policy }));\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'TrustedHTML':\n\t\t\tif (typeof elementNs === 'string') {\n\t\t\t\tel.setAttributeNS(elementNs, attr, createHTML(val, { policy }));\n\t\t\t} else {\n\t\t\t\tel.setAttribute(attr, createHTML(val, { policy }));\n\t\t\t}\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tif (typeof elementNs === 'string') {\n\t\t\t\tel.setAttributeNS(elementNs, attr, val);\n\t\t\t} else {\n\t\t\t\tel.setAttribute(attr, val);\n\t\t\t}\n\t}\n}\n\nexport function supported() {\n\treturn 'trustedTypes' in globalThis\n\t\t&& trustedTypes instanceof EventTarget\n\t\t&& trustedTypes.createPolicy instanceof Function;\n}\n\nexport function isTrustPolicy(policy) {\n\tif ('TrustedTypePolicy' in globalThis && policy instanceof TrustedTypePolicy) {\n\t\treturn true;\n\t} else {\n\t\treturn policy != null && policy.createHTML instanceof Function;\n\t}\n}\n\nexport function hasDefaultPolicy() {\n\treturn supported() && isTrustPolicy(trustedTypes.defaultPolicy);\n}\n\nexport function getAttributeType(tagName, attribute, elementNs) {\n\tif (supported()) {\n\t\treturn trustedTypes.getAttributeType(tagName.toLowerCase(), attribute, elementNs);\n\t} else {\n\t\treturn null;\n\t}\n}\n\nexport function getPropertyType(tagName, property) {\n\tif (supported()) {\n\t\treturn trustedTypes.getPropertyType(tagName.toLowerCase(), property);\n\t} else {\n\t\treturn null;\n\t}\n}\n\nexport function isHTML(input) {\n\tif (supported()) {\n\t\treturn trustedTypes.isHTML(input);\n\t} else {\n\t\treturn typeof input === 'string';\n\t}\n}\n\nexport function isScript(input) {\n\tif (supported()) {\n\t\treturn trustedTypes.isScript(input);\n\t} else {\n\t\treturn typeof input === 'string';\n\t}\n}\n\nexport function isScriptURL(input) {\n\tif (supported()) {\n\t\treturn trustedTypes.isScriptURL(input);\n\t} else {\n\t\treturn typeof input === 'string' || input instanceof URL;\n\t}\n}\n\nexport function isTrustedType(input) {\n\tif (supported()) {\n\t\treturn trustedTypes.isHTML(input) || trustedTypes.isScript(input) || trustedTypes.isScriptURL(input);\n\t} else {\n\t\treturn true;\n\t}\n}\n\nexport function createHTML(input, { policy = getDefaultPolicy() } = {}) {\n\tif (isTrustPolicy(policy) && ! isHTML(input)) {\n\t\treturn policy.createHTML(input);\n\t} else {\n\t\treturn input;\n\t}\n}\n\nexport function createScript(input, { policy = getDefaultPolicy() } = {}) {\n\tif (isTrustPolicy(policy) && ! isScript(input)) {\n\t\treturn policy.createScript(input);\n\t} else {\n\t\treturn input;\n\t}\n}\n\nexport function createScriptURL(input, { policy = getDefaultPolicy() } = {}) {\n\tif (isTrustPolicy(policy) && ! isScriptURL(input)) {\n\t\treturn policy.createScriptURL(input);\n\t} else {\n\t\treturn input;\n\t}\n}\n\nexport function createPolicy(name, {\n\tcreateHTML = () => {\n\t\tthrow new TypeError('This policy does not provide `createHTML()`');\n\t},\n\tcreateScript = () => {\n\t\tthrow new TypeError('This policy does not provide `createScript()`');\n\t},\n\tcreateScriptURL = () => {\n\t\tthrow new TypeError('This policy does not provide `createScriptURL()`');\n\t},\n}) {\n\tif (supported()) {\n\t\treturn trustedTypes.createPolicy(name, { createHTML, createScript, createScriptURL });\n\t} else {\n\t\treturn Object.freeze({\n\t\t\tname,\n\t\t\tcreateHTML: (input, ...args) => createHTML(input.toString(), ...args),\n\t\t\tcreateScript: (input, ...args) => createScript(input.toString(), ...args),\n\t\t\tcreateScriptURL: (input, ...args) => createScriptURL(input.toString(), ...args),\n\t\t});\n\t}\n}\n\nexport function getDefaultPolicy() {\n\tif (supported()) {\n\t\treturn trustedTypes.defaultPolicy;\n\t} else {\n\t\treturn null;\n\t}\n}\n\nexport const createHTMLPolicyGetter = (name, cb) => callOnce(() => createPolicy(name, { createHTML: cb }));\n\nexport const createScriptPolicyGetter = (name, cb) => callOnce(() => createPolicy(name, { createScript: cb }));\n\nexport const createScriptURLPolicyGetter = (name, cb) => callOnce(() => createPolicy(name, { createScriptURL: cb }));\n","/**\n * @copyright 2023 Chris Zuber <admin@kernvalley.us>\n */\nimport { randomInt } from './math.js';\nimport { isAsyncFunction, getDeferred } from './promises.js';\nimport { isScriptURL, isTrustPolicy } from './trust.js';\n\nconst funcs = new WeakMap();\n\nexport function isStrictMode() {\n\t// Probably always true\n\treturn typeof this === 'undefined';\n}\n\nexport const autoServiceWorkerRegistration = callOnce(async ({\n\tpolicy = 'trustedTypes' in globalThis ? trustedTypes.defaultPolicy : null,\n} = {}) => {\n\tif ('serviceWorker' in navigator && 'serviceWorker' in document.documentElement.dataset) {\n\t\tconst { serviceWorker, scope = '/', updateViaCache } = document.documentElement.dataset;\n\n\t\ttry {\n\t\t\tif (isTrustPolicy(policy)) {\n\t\t\t\tawait registerServiceWorker(policy.createScriptURL(serviceWorker), { scope, updateViaCache });\n\t\t\t} else {\n\t\t\t\tawait registerServiceWorker(serviceWorker, { scope, updateViaCache });\n\t\t\t}\n\n\t\t\tawait reloadOnUpdate();\n\t\t} catch(err) {\n\t\t\tconsole.error(err);\n\t\t}\n\t}\n});\n\nexport async function reloadOnUpdate() {\n\tif ('serviceWorker' in navigator && 'reloadOnUpdate' in document.documentElement.dataset) {\n\t\tconst reg = await navigator.serviceWorker.ready;\n\n\t\treg.addEventListener('updatefound', async ({ target }) => {\n\t\t\ttarget.update();\n\n\t\t\tconst HTMLNotificationElement = await customElements.whenDefined('html-notification');\n\t\t\tconst notification = new HTMLNotificationElement('Update available', {\n\t\t\t\tbody: 'App updated in background. Would you like to reload to see updates?',\n\t\t\t\trequireInteraction: true,\n\t\t\t\tactions: [{\n\t\t\t\t\ttitle: 'Reload',\n\t\t\t\t\taction: 'reload',\n\t\t\t\t}, {\n\t\t\t\t\ttitle: 'Dismiss',\n\t\t\t\t\taction: 'dismiss',\n\t\t\t\t}]\n\t\t\t});\n\n\t\t\tnotification.addEventListener('notificationclick', ({ target, action }) => {\n\t\t\t\tswitch(action) {\n\t\t\t\t\tcase 'dismiss':\n\t\t\t\t\t\ttarget.close();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'reload':\n\t\t\t\t\t\ttarget.close();\n\t\t\t\t\t\tlocation.reload();\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n}\n\nexport async function registerServiceWorker(source, {\n\tscope,\n\tpolicy = 'trustedTypes' in globalThis ? trustedTypes.defaultPolicy : null,\n\ttype = 'classic',\n\tupdateViaCache = 'none',\n} = {}) {\n\tconst { resolve, reject, promise } = getDeferred();\n\n\tif (! ('serviceWorker' in navigator && navigator.serviceWorker.register instanceof Function)) {\n\t\treject(new DOMException('Service worker not supported'));\n\t} else if (! (typeof source === 'string' || isScriptURL(source) || source instanceof URL)) {\n\t\treject(new TypeError('Invalid Service worker registration source'));\n\t} else if (! isScriptURL(source) && isTrustPolicy(policy)) {\n\t\tnavigator.serviceWorker.register(\n\t\t\tpolicy.createScriptURL(source),\n\t\t\t{ scope, type, updateViaCache }\n\t\t).then(resolve).catch(reject);\n\t} else {\n\t\tnavigator.serviceWorker.register(source, { scope, type, updateViaCache })\n\t\t\t.then(resolve).catch(reject);\n\t}\n\n\treturn await promise;\n}\n\nexport function getURLResolver({ base = document.baseURI, path = './' } = {}) {\n\tconst url = new URL(path, base);\n\n\treturn path => new URL(path, url).href;\n}\n\nexport function isObject(thing) {\n\treturn typeof thing === 'object' && ! Object.is(thing, null) && ! Array.isArray(thing);\n}\n\nexport function isNull(val) {\n\treturn Object.is(val, null);\n}\n\nexport function isUndefined(val) {\n\treturn typeof val === 'undefined';\n}\n\nexport function isIterable(thing) {\n\treturn Array.isArray(thing) || (isObject(thing) && thing[Symbol.iterator] instanceof Function);\n}\n\nexport function isNullish(val) {\n\tswitch (typeof val) {\n\t\tcase 'undefined':\n\t\t\treturn true;\n\n\t\tcase 'object':\n\t\t\tif (Object.is(val, null)) {\n\t\t\t\treturn true;\n\t\t\t} else if (Array.isArray(val)) {\n\t\t\t\treturn val.length === 0;\n\t\t\t} else if (val instanceof Date) {\n\t\t\t\treturn Number.isNaN(val.getTime());\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\tcase 'number':\n\t\t\treturn Number.isNaN(val);\n\n\t\tcase 'string':\n\t\t\treturn val.length === 0;\n\n\t\tdefault:\n\t\t\treturn false;\n\t}\n}\n\nexport function getType(thing) {\n\tswitch (typeof thing) {\n\t\tcase 'undefined':\n\t\t\treturn 'Undefined';\n\n\t\tcase 'function':\n\t\t\tif ('prototype' in thing) {\n\t\t\t\treturn getType(thing.prototype);\n\t\t\t} else if ('constructor' in thing) {\n\t\t\t\treturn thing.constructor.name;\n\t\t\t} else {\n\t\t\t\treturn 'Function';\n\t\t\t}\n\n\t\tcase 'object':\n\t\t\tif (Object.is(thing, null)) {\n\t\t\t\treturn 'Null';\n\t\t\t} else if ('constructor' in thing) {\n\t\t\t\treturn thing.constructor.name;\n\t\t\t} else if (Symbol.toStringTag in thing) {\n\t\t\t\treturn thing[Symbol.toStringTag];\n\t\t\t} else if ('prototype' in thing) {\n\t\t\t\treturn  getType(thing.prototype);\n\t\t\t} else {\n\t\t\t\tconsole.log(thing);\n\t\t\t\treturn 'Unknown Object';\n\t\t\t}\n\n\t\tcase 'string':\n\t\t\treturn 'String';\n\n\t\tcase 'number':\n\t\t\treturn Number.isNaN(thing) ? 'NaN' : 'Number';\n\n\t\tcase 'bigint':\n\t\t\treturn 'BigInt';\n\n\t\tcase 'boolean':\n\t\t\treturn 'Boolean';\n\n\t\tcase 'symbol':\n\t\t\treturn 'Symbol';\n\n\t\tdefault:\n\t\t\treturn 'Unknown';\n\t}\n}\n\nexport function isA(thing, expectedType) {\n\tif (typeof expectedType === 'string') {\n\t\treturn getType(thing) === expectedType;\n\t} else if (isObject(expectedType) && 'constructor' in expectedType) {\n\t\treturn isA(thing, expectedType.constructor.name);\n\t} else {\n\t\tthrow new TypeError('Invalid argument for `expectedType`');\n\t}\n}\n\nexport function sameType(thing1, thing2) {\n\treturn isA(thing1, getType(thing2));\n}\n\nexport function deepEquals(thing1, thing2, { depth = 5 } = {}) {\n\tconst type1 = getType(thing1);\n\tconst type2 = getType(thing2);\n\n\tif (! Number.isSafeInteger(depth)) {\n\t\tthrow new TypeError('`depth` must be an integer');\n\t} else if (type1 !== type2) {\n\t\treturn false;\n\t} else if (thing1 === thing2) {\n\t\treturn true;\n\t} else {\n\t\tdepth--;\n\t\tswitch(type1) {\n\t\t\tcase 'NaN':\n\t\t\t\t// Since NaN !== NaN\n\t\t\t\treturn true;\n\n\t\t\tcase 'BigInt':\n\t\t\tcase 'Number':\n\t\t\tcase 'String':\n\t\t\tcase 'Symbol':\n\t\t\tcase 'Boolean':\n\t\t\t\t// Already know not equal\n\t\t\t\treturn false;\n\n\t\t\tcase 'Object':\n\t\t\t\treturn depth < 0 || deepEquals(Object.entries(thing1), Object.entries(thing2), { depth });\n\n\t\t\tcase 'Array':\n\t\t\t\treturn depth < 0 || (\n\t\t\t\t\tthing1.length === thing2.length\n\t\t\t\t\t&& thing1.every((thing, i) => deepEquals(thing, thing2[i], { depth }))\n\t\t\t\t);\n\n\t\t\tcase 'Map':\n\t\t\tcase 'Set':\n\t\t\t\treturn depth < 0 || deepEquals([...thing1], [...thing2], { depth });\n\n\t\t\tcase 'URL':\n\t\t\t\treturn thing1.href === thing2.href;\n\n\t\t\tdefault:\n\t\t\t\tif (thing1 instanceof Node) {\n\t\t\t\t\treturn thing1.isSameNode(thing2);\n\t\t\t\t} else if (Symbol.iterator in thing1) {\n\t\t\t\t\treturn depth < 0 || deepEquals([...thing1], [...thing2], { depth });\n\t\t\t\t} else {\n\t\t\t\t\t// Since already not `===`\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t}\n\t}\n}\n\n/* global define */\nexport function amd(name, factory, requires = {}) {\n\tif (typeof define === 'function' && define.amd) {\n\t\t// AMD. Register as an anonymous module.\n\t\ttry {\n\t\t\tdefine(name, requires, factory);\n\t\t\treturn true;\n\t\t} catch(err) {\n\t\t\tconsole.error(err);\n\t\t\treturn false;\n\t\t}\n\t} else {\n\t\treturn false;\n\t}\n}\n\nexport function errorToEvent(error, type = 'error') {\n\tif (error instanceof Error) {\n\t\tconst { message, name, fileName: filename, lineNumber: lineno, columnNumber: colno } = error;\n\t\treturn new ErrorEvent(type, { error, message: `${name}: ${message}`, filename, lineno, colno });\n\t} else {\n\t\tthrow new TypeError('`errorToEvent()` only accepts Errors');\n\t}\n}\n\nexport function callOnce(callback, thisArg) {\n\tif (callback.once instanceof Function) {\n\t\treturn callback.once(thisArg);\n\t} else {\n\t\treturn function(...args) {\n\t\t\tif (funcs.has(callback)) {\n\t\t\t\treturn funcs.get(callback);\n\t\t\t} else if (isAsyncFunction(callback)) {\n\t\t\t\tconst retVal = callback.apply(thisArg || this, args).catch(err => {\n\t\t\t\t\tfuncs.delete(callback);\n\t\t\t\t\tthrow err;\n\t\t\t\t});\n\n\t\t\t\tfuncs.set(callback, retVal);\n\t\t\t\treturn retVal;\n\t\t\t} else if (callback instanceof Function) {\n\t\t\t\tconst retVal = callback.apply(thisArg || this, args);\n\t\t\t\tfuncs.set(callback, retVal);\n\t\t\t\treturn retVal;\n\t\t\t}\n\t\t};\n\t}\n}\n\nexport function setURLParams(forURL, params) {\n\tconst url = new URL(forURL, document.baseURI);\n\n\tif (params instanceof HTMLFormElement) {\n\t\treturn setURLParams(url, new FormData(params));\n\t} else if (params instanceof FormData) {\n\t\treturn setURLParams(url, Object.fromEntries(params));\n\t} else if (params instanceof URLSearchParams) {\n\t\treturn setURLParams(url, Object.fromEntries(params));\n\t} else if (Array.isArray(params) || typeof params === 'string') {\n\t\treturn setURLParams(url, new URLSearchParams(params));\n\t} else if (isObject(params)) {\n\t\tObject.entries(params).forEach(([k, v]) => {\n\t\t\tif (typeof v === 'string' || (typeof v === 'number' && ! Number.isNaN(v))) {\n\t\t\t\turl.searchParams.set(k, v);\n\t\t\t} else if (typeof v === 'boolean') {\n\t\t\t\tif (v) {\n\t\t\t\t\turl.searchParams.set(k, '');\n\t\t\t\t} else {\n\t\t\t\t\turl.searchParams.delete(k);\n\t\t\t\t}\n\t\t\t} else if (! isNullish(v)) {\n\t\t\t\turl.searchParams.set(k, v.toString());\n\t\t\t}\n\t\t});\n\t}\n\n\treturn url;\n}\n\nexport function setUTMParams(url, {\n\tsource: utm_source,\n\tmedium: utm_medium = 'referral',\n\tcontent: utm_content,\n\tcampaign: utm_campaign,\n\tterm: utm_term,\n} = {}) {\n\tif (isNullish(url)) {\n\t\treturn null;\n\t} else if (! (url instanceof URL)) {\n\t\treturn setUTMParams(new URL(url, document.baseURI), {\n\t\t\tsource: utm_source,\n\t\t\tmedium: utm_medium,\n\t\t\tcontent: utm_content,\n\t\t\tcampaign: utm_campaign,\n\t\t\tterm: utm_term,\n\t\t});\n\t} else if (typeof utm_source !== 'string') {\n\t\treturn url;\n\t} else {\n\t\treturn setURLParams(url, { utm_source, utm_medium, utm_content, utm_campaign, utm_term });\n\t}\n}\n\nexport function debounce(callback, { delay = 17, thisArg } = {}) {\n\tif (! (callback instanceof Function)) {\n\t\tthrow new TypeError('Callback must be a function');\n\t} else if (! Number.isFinite(delay) || delay < 0) {\n\t\tthrow new TypeError('Timeout must be a positive intiger');\n\t} else {\n\t\tlet to;\n\t\treturn function(...args) {\n\t\t\tif (typeof to === 'number') {\n\t\t\t\tclearTimeout(to);\n\t\t\t\tto = null;\n\t\t\t}\n\t\t\tto = setTimeout((...args) => callback.apply(thisArg, args), delay, ...args);\n\t\t};\n\t}\n}\n\nexport function throttle(callback, { delay = 17, thisArg } = {}) {\n\tif (! (callback instanceof Function)) {\n\t\tthrow new TypeError('Callback must be a function');\n\t} else if (! Number.isFinite(delay) || delay < 0) {\n\t\tthrow new TypeError('Timeout must be a positive intiger');\n\t} else {\n\t\tlet to;\n\t\treturn function(...args) {\n\t\t\tif (typeof to !== 'number') {\n\t\t\t\tto = setTimeout(() => to = null, delay);\n\t\t\t\tcallback.apply(thisArg, args);\n\t\t\t}\n\t\t};\n\t}\n}\n\nexport function random(arr) {\n\tif (Array.isArray(arr) && arr.length !== 0) {\n\t\treturn arr[randomInt(0, arr.length)];\n\t}\n}\n\nexport const toSpinalCase = str => str.replace(/[A-Z]/g, (m, i) => i === 0\n\t? m.toLowerCase()\n\t: `-${m.toLowerCase()}`);\n\nexport const toCamelCase = str => str.replace(/-[a-z\\d]/g, m => m.substr(1).toUpperCase());\n\nexport const ucFirst = str => str.substr(0, 1).toUpperCase() + str.substr(1);\n","/**\n * @copyright 2023 Chris Zuber <admin@kernvalley.us>\n */\nimport { query, when } from './dom.js';\nimport { signalAborted } from './abort.js';\nimport { getDeferred } from './promises.js';\nimport { debounce as db, throttle } from './utility.js';\n\nexport async function loaded(target, {\n\tsignal: passedSignal,\n\tsuccess = 'load',\n\terror = 'error',\n} = {}) {\n\treturn await new Promise(async (resolve, reject) => {\n\t\tif (passedSignal instanceof AbortSignal && passedSignal.aborted) {\n\t\t\treject(passedSignal.reason);\n\t\t} else if (target instanceof HTMLScriptElement && target.noModule && HTMLScriptElement.supports('module')) {\n\t\t\t/**\n\t\t\t * <script nomodule> will never load\n\t\t\t */\n\t\t\tresolve(target);\n\t\t} else if (target instanceof HTMLLinkElement && target.disabled) {\n\t\t\t/**\n\t\t\t * <link disabled> will never load\n\t\t\t */\n\t\t\tresolve(target);\n\t\t} else if (target instanceof HTMLImageElement && target.loading === 'lazy' && !(target.parentElement instanceof Element)) {\n\t\t\t/**\n\t\t\t * <img loading=\"lazy\"> will not load until appended\n\t\t\t */\n\t\t\tresolve(target);\n\t\t} else if (target instanceof HTMLImageElement && target.decode instanceof Function) {\n\t\t\tawait target.decode();\n\t\t\treturn target;\n\t\t} else {\n\t\t\tconst controller = new AbortController();\n\t\t\tconst signal = passedSignal instanceof AbortSignal ? AbortSignal.any([\n\t\t\t\tpassedSignal,\n\t\t\t\tcontroller.signal,\n\t\t\t]) : passedSignal;\n\n\t\t\tlisten(target, success, ({ target }) => {\n\t\t\t\tresolve(target);\n\t\t\t\tcontroller.abort();\n\t\t\t}, { once: true, signal });\n\n\t\t\tlisten(target, error, ({ target: { tagName, src, href} }) => {\n\t\t\t\tconst error = new Error(`Failed to load <${tagName.toLowerCase()}>`, {\n\t\t\t\t\tcause: new Error(`Request to ${src || href} failed`),\n\t\t\t\t});\n\n\t\t\t\treject(error);\n\t\t\t\tcontroller.abort(error);\n\t\t\t}, { once: true, signal });\n\n\t\t\tif (passedSignal instanceof AbortSignal) {\n\t\t\t\tlisten(passedSignal, 'abort', ({ target: { reason }}) => {\n\t\t\t\t\tif (! controller.signal.aborted) {\n\t\t\t\t\t\treject(reason);\n\t\t\t\t\t\tcontroller.abort(reason);\n\t\t\t\t\t}\n\t\t\t\t}, { once: true, signal: controller.signal });\n\t\t\t}\n\t\t}\n\t});\n}\n\nexport function getEventFeatures() {\n\tconst el = document.createElement('div');\n\tconst eventFeatures = {\n\t\tnativeSignal: 'AbortController' in globalThis && AbortController.prototype.hasOwnProperty('signal'),\n\t\tsignal: false,\n\t\tpassive: false,\n\t\tcapture: false,\n\t\tonce: false,\n\t};\n\n\t// Use of a getter will detect support when properties are read\n\tconst options = {\n\t\tget passive() {\n\t\t\teventFeatures.passive = true;\n\t\t\treturn undefined;\n\t\t},\n\t\tget signal() {\n\t\t\teventFeatures.signal = true;\n\t\t\treturn undefined;\n\t\t},\n\t\tget capture() {\n\t\t\teventFeatures.capture = true;\n\t\t\treturn undefined;\n\t\t},\n\t\tget once() {\n\t\t\teventFeatures.once = true;\n\t\t\treturn undefined;\n\t\t},\n\t};\n\n\ttry {\n\t\tel.addEventListener('click', null, options);\n\t\tel.removeEventListener('click', null, options);\n\t} catch(err) {\n\t\tconsole.error(err);\n\t}\n\n\treturn Object.seal(eventFeatures);\n}\n\nexport const features = getEventFeatures();\n\nexport function addListener(targets, events, callback, { capture, once, passive, signal } = {}) {\n\tif (! Array.isArray(targets)) {\n\t\ttargets = query(targets);\n\t}\n\n\tif (! Array.isArray(events)) {\n\t\tevents = Array.of(events);\n\t}\n\n\ttargets.forEach(target => {\n\t\tevents.forEach(event => listen(target, event, callback, { capture, once, passive, signal }));\n\t});\n}\n\nexport function listen(target, event, callback, { capture, once, passive, signal } = {}) {\n\tif (! (signal instanceof EventTarget && signal.aborted)) {\n\t\ttarget.addEventListener(event, callback, { capture, once, passive, signal });\n\n\t\tif (features.signal === false && signal instanceof EventTarget) {\n\t\t\tsignalAborted(signal).finally(() => target.removeEventListener(event, callback, { capture, once, passive, signal }));\n\t\t}\n\t}\n}\n\nexport async function once(target, event, { capture, passive, signal } = {}) {\n\tconst { resolve, promise } = getDeferred({ signal, reason: new DOMException('Operation aborted') });\n\tlisten(target, event, resolve, { capture, once: true, passive, signal });\n\treturn await promise;\n}\n\nexport function removeListener(targets, events, callback, { capture, once, passive, signal } = {}) {\n\tif (! Array.isArray(targets)) {\n\t\ttargets = query(targets);\n\t}\n\n\tif (! Array.isArray(events)) {\n\t\tevents = Array.of(events);\n\t}\n\n\ttargets.forEach(target => {\n\t\tevents.forEach(event => target.removeEventListener(event, callback, { capture, once, passive, signal }));\n\t});\n}\n\n/**\n * Control the execution rate of callbacks, i.e. for listeners\n * https://davidwalsh.name/function-debounce\n *\n * @param  Callable callback    The callback\n * @param  int      [ms]        Number of milliseconds, defaulting to 1/60th a second\n * @param  bool     [immediate] Trigger function immediately instead of after wait ms\n * @return function             Rate limited function\n */\nexport function debounce(func, wait = 17, immediate = false) {\n\tconsole.warn('debounce() in events.js is deprecated. Please use utility.js instead.');\n\treturn immediate ? throttle(func, { delay: wait }): db(func, { delay: wait });\n}\n\nexport async function whenOnline({ signal } = {}) {\n\tif (navigator.onLine === false) {\n\t\tawait when(window, 'online', { signal });\n\t}\n}\n\nexport async function whenOffline({ signal } = {}) {\n\tif (navigator.onLine === true) {\n\t\tawait when(window, 'offline', { signal });\n\t}\n}\n\nexport async function whenVisible({ signal } = {}) {\n\tif (document.visibilityState === 'hidden') {\n\t\tawait when(document, 'visibilitychange', { signal });\n\t}\n}\n\nexport async function whenHidden({ signal } = {}) {\n\tif (document.visibilityState === 'visible') {\n\t\tawait when(document, 'visibilitychange', { signal });\n\t}\n}\n\nexport async function* yieldEvents(target, event, { capture, passive, signal } = {}) {\n\tconst pending = [];\n\tconst def = {};\n\n\tif (! (signal instanceof AbortSignal)) {\n\t\tthrow new TypeError('`signal` required to be an `AbortSignal`.');\n\t}\n\n\ttarget.addEventListener(event, ev => {\n\t\tif (def.resolve instanceof Function) {\n\t\t\tconst resolve = def.resolve;\n\t\t\tdelete def.resolve;\n\t\t\tresolve(ev);\n\t\t} else {\n\t\t\tpending.push(ev);\n\t\t}\n\t}, { capture, passive, signal });\n\n\twhile (! signal.aborted) {\n\t\twhile (pending.length !== 0 && ! signal.aborted) {\n\t\t\tyield pending.shift();\n\t\t}\n\n\t\tif (! (def.resolve instanceof Function)) {\n\t\t\tconst { resolve, promise, reject } = getDeferred();\n\t\t\tdef.resolve = resolve;\n\t\t\tdef.reject = reject;\n\t\t\tdef.promise = promise;\n\t\t}\n\n\t\tyield await def.promise;\n\t}\n\n\treturn pending;\n}\n","/**\n * @copyright 2023 Chris Zuber <admin@kernvalley.us>\n */\nimport { when, beforeUnload, unloaded } from './dom.js';\nimport { getDeferred } from './promises.js';\nimport { listen } from './events.js';\nexport const supported =  'AbortController' in window && AbortController.prototype.hasOwnProperty('signal');\n\nexport function throwIfAborted(signal) {\n\tif (signal instanceof AbortController) {\n\t\tsignal.signal.throwIfAborted();\n\t} else if (signal instanceof AbortSignal) {\n\t\tsignal.throwIfAborted();\n\t}\n}\n\nexport function getBeforeUnloadSignal() {\n\tconst controller = new AbortController();\n\tbeforeUnload().then(() => controller.abort());\n\treturn controller.signal;\n}\n\nexport function getUnloadSignal() {\n\tconst controller = new AbortController();\n\tunloaded().then(() => controller.abort());\n\treturn controller.signal;\n}\n\nexport function isAborted(signal) {\n\tif (signal instanceof AbortController) {\n\t\treturn signal.signal.aborted;\n\t} else {\n\t\treturn signal instanceof AbortSignal && signal.aborted;\n\t}\n}\n\nexport async function signalAborted(signal) {\n\tconst { reject, promise } = getDeferred();\n\n\tif (signal instanceof AbortController) {\n\t\treturn signalAborted(signal.signal);\n\t} else if (! (signal instanceof EventTarget)) {\n\t\treject(new DOMException('Not an AbortSignal'));\n\t} else if (signal.aborted) {\n\t\treject(signal.reason);\n\t} else {\n\t\tsignal.addEventListener('abort', ({ target }) => reject(target.reason),{ once: true });\n\t}\n\n\treturn promise;\n}\n\nexport function abortButtonController(button, { reason } = {}) {\n\tif (! (button instanceof HTMLButtonElement)) {\n\t\tthrow new TypeError('Not a <button>');\n\t}\n\n\tconst controller = new AbortController();\n\tbutton.disabled = false;\n\n\tlisten(button, 'click', () => controller.abort(reason), { signal: controller.signal, once: true });\n\tlisten(controller.signal, 'abort', () => button.disabled = true, { once: true });\n\n\treturn controller;\n}\n\n/**\n * @deprecated\n */\nexport function abortTimeoutController(timeout, { reason } = {}) {\n\tconsole.warn('`abortTimeoutController()` is deprecated. Use `AbortSignal.timeout()` instead.');\n\tconst controller = new AbortController();\n\n\tabortableTimeout(() => controller.abort(reason), timeout, { signal: controller.signal });\n\n\treturn controller;\n}\n\n/**\n * @deprecated\n */\nexport function abortTimeoutSignal(timeout, { reason } = {}) {\n\treturn abortTimeoutController(timeout, { reason }).signal;\n}\n\nexport function abortEventController(what, events, { passive, capture, reason } = {}) {\n\tconst controller = new AbortController();\n\n\twhen(what, events, { signal: controller.signal, capture, passive, once: true }).then(() => {\n\t\tif (! controller.signal.aborted) {\n\t\t\tcontroller.abort(reason);\n\t\t}\n\t});\n\n\treturn controller;\n}\n\nexport function abortableTimeout(callback, ms, { signal } = {}) {\n\tconst id = setTimeout(() => callback(), ms);\n\n\tif (signal instanceof AbortSignal) {\n\t\tsignalAborted(signal).finally(() => clearTimeout(id));\n\t}\n\n\treturn id;\n}\n\nexport function abortableInterval(callback, ms, { signal } = {}) {\n\tconst id = setInterval(() => callback(), ms);\n\n\tif (signal instanceof AbortSignal) {\n\t\tsignalAborted(signal).finally(() => clearInterval(id));\n\t}\n\n\treturn id;\n}\n\nexport function abortableAnimationFrame(callback, { signal } = {}) {\n\tconst id = requestAnimationFrame(callback);\n\n\tif (signal instanceof AbortSignal) {\n\t\tsignalAborted(signal).finally(() => cancelAnimationFrame(id));\n\t}\n\n\treturn id;\n}\n\nexport function abortableIdleCallback(callback, { signal, timeout } = {}) {\n\tconst id = requestIdleCallback(callback);\n\n\tif (signal instanceof AbortSignal) {\n\t\tsignalAborted(signal).finally(() => cancelIdleCallback(id, { timeout }));\n\t}\n\n\treturn id;\n}\n\nexport function signalRaceController(...signals) {\n\tconst controller = new AbortController();\n\tconst signal = anyAbortedSignal(...signals);\n\n\tsignal.addEventListener('abort', ({ target }) => {\n\t\tcontroller.abort(target.reason || new DOMException('Operation aborted.'));\n\t}, { signal: controller.signal });\n\n\treturn controller;\n}\n\nexport function signalAllController(...signals) {\n\tconst controller = new AbortController();\n\n\tPromise.all(signals.map(signal => signalAborted(signal))).finally(() => controller.abort());\n\n\treturn controller;\n}\n\nexport function anyAbortedSignal(...signals) {\n\tif (AbortSignal.any instanceof Function) {\n\t\treturn AbortSignal.any(signals);\n\t} else {\n\t\tconst controller = new AbortController();\n\n\t\tfor (const signal of signals) {\n\t\t\tif (! (signal instanceof AbortSignal)) {\n\t\t\t\tconst err = new TypeError('`signal` is not an `AbortSignal`');\n\t\t\t\tcontroller.abort(err);\n\t\t\t\tthrow err;\n\t\t\t} else if (signal.aborted) {\n\t\t\t\tcontroller.abort(signal.reason || new DOMException('Operation aborted.'));\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tsignal.addEventListener('abort', ({ target }) => {\n\t\t\t\t\tcontroller.abort(target.reason || new DOMException('Operation aborted.'));\n\t\t\t\t}, { signal: controller.signal });\n\t\t\t}\n\t\t}\n\n\t\treturn controller.signal;\n\t}\n}\n","/**\n * @copyright 2023 Chris Zuber <admin@kernvalley.us>\n */\nexport const TEXT = 'text/plain';\nexport const HTML = 'text/html';\nexport const CSS = 'text/css';\nexport const JS = 'application/javascript';\nexport const JSON = 'application/json';\nexport const XML = 'application/xml';\nexport const JSON_LD = 'application/ld+json';\nexport const JPEG = 'image/jpeg';\nexport const PNG = 'image/png';\nexport const GIF = 'image/gif';\nexport const WEBP = 'image/webp';\nexport const SVG = 'image/svg+xml';\nexport const FORM_URL_ENCODED = 'application/x-www-form-urlencoded';\nexport const FORM_MULTIPART = 'multipart/form-data';\n","/**\n * @copyright 2023 Chris Zuber <admin@kernvalley.us>\n */\nimport { clamp, between } from './math.js';\nimport { isObject, isNullish } from './utility.js';\nimport { toHexColor, parseHexColor } from './color-utils.js';\nimport { setAttr, isScriptURL, isTrustedType } from './trust.js';\nimport { COLOR } from './patterns.js';\n\nexport function getAttrs(el) {\n\tif (typeof el === 'string') {\n\t\treturn getAttrs(document.querySelector(el));\n\t} else if (el instanceof Element) {\n\t\treturn Object.fromEntries([...el.attributes].map(({ name, value }) => [name, value]));\n\t} else {\n\t\tthrow new TypeError(`Expected an element or selector but got a ${typeof el}`);\n\t}\n}\n\nexport function aria(el, props = {}) {\n\tif (! (el instanceof Element)) {\n\t\tthrow new TypeError('`el` must be an Element');\n\t} else {\n\t\tObject.entries(props).forEach(([prop, val]) => {\n\t\t\tif (prop !== 'role') {\n\t\t\t\tprop = `aria-${prop.toLowerCase()}`;\n\t\t\t}\n\n\t\t\tif (isNullish(val)) {\n\t\t\t\tel.removeAttribute(prop);\n\t\t\t} else {\n\t\t\t\tel.setAttribute(prop, val);\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport function data(el, props = {}) {\n\tif (! (el instanceof Element)) {\n\t\tthrow new TypeError('el must be an Element');\n\t} if (! isObject(props)) {\n\t\tthrow new TypeError('props must be an object');\n\t} else {\n\t\tObject.entries(props).forEach(([p, v]) => {\n\t\t\tswitch (typeof v) {\n\t\t\t\tcase 'string':\n\t\t\t\tcase 'number':\n\t\t\t\t\tel.dataset[p] = v.toString();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'boolean':\n\t\t\t\t\tif (v) {\n\t\t\t\t\t\tel.dataset[p] = '';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdelete el.dataset[p];\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'undefined':\n\t\t\t\t\tdelete el.dataset[p];\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'object':\n\t\t\t\t\tif (Object.is(v, null)) {\n\t\t\t\t\t\tdelete el.dataset[p];\n\t\t\t\t\t} else if (v instanceof Date) {\n\t\t\t\t\t\tel.dataset[p] = v.toISOString();\n\t\t\t\t\t} else if (v instanceof URL) {\n\t\t\t\t\t\tel.dataset[p] = v.href;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tel.dataset[p] = JSON.stringify(v);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new TypeError(`Unable to handle type: ${typeof v}`);\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport function css(el, props = {}, { priority } = {}) {\n\tif (! (el instanceof Element)) {\n\t\tthrow new TypeError('el must be an Element');\n\t} if (! isObject(props)) {\n\t\tthrow new TypeError('props must be an object');\n\t} else {\n\t\tObject.entries(props).forEach(([p, v]) => {\n\t\t\tif (typeof v === 'string' || typeof v === 'number') {\n\t\t\t\tel.style.setProperty(p, v, priority);\n\t\t\t} else if (v instanceof URL) {\n\t\t\t\tel.type.setProperty(p, v.href, priority);\n\t\t\t} else if (typeof v === 'object' && ! Object.is(v, null) && v.toString instanceof Function) {\n\t\t\t\tel.style.setProperty(p, v.toString(), priority);\n\t\t\t} else {\n\t\t\t\tel.style.removeProperty(p);\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport function attr(el, props = {}, {\n\tnamespace: elementNs = null,\n\tpolicy,\n} = {}) {\n\tif (! (el instanceof Element)) {\n\t\tthrow new TypeError('el must be an Element');\n\t} if (! isObject(props)) {\n\t\tthrow new TypeError('props must be an object');\n\t} else {\n\t\tObject.entries(props).forEach(([p, v]) => {\n\t\t\tif (typeof v === 'string' || typeof v === 'number') {\n\t\t\t\tsetAttr(el, p, v, { policy, elementNs });\n\t\t\t} else if ('trustedTypes' in globalThis && isTrustedType(v)) {\n\t\t\t\tif (v.toString().length === 0) {\n\t\t\t\t\tel.removeAttribute(p);\n\t\t\t\t} else {\n\t\t\t\t\tsetAttr(el, p, v, { policy, elementNs });\n\t\t\t\t}\n\t\t\t} else if (typeof v === 'boolean') {\n\t\t\t\tif (typeof namespace === 'string') {\n\t\t\t\t\tv ? el.setAttributeNS(elementNs, p, '') : el.removeAttributeNS(elementNs, p);\n\t\t\t\t} else {\n\t\t\t\t\tel.toggleAttribute(p, v);\n\t\t\t\t}\n\t\t\t} else if (v instanceof Date) {\n\t\t\t\tsetAttr(el, p, v.toISOString(), { policy, elementNs });\n\t\t\t} else if (v instanceof URL) {\n\t\t\t\tsetAttr(el, p, v.href, { policy, elementNs });\n\t\t\t} else if (typeof v === 'undefined' || v === null) {\n\t\t\t\tif (typeof namespace === 'string') {\n\t\t\t\t\tel.removeAttributeNS(elementNs, p);\n\t\t\t\t} else {\n\t\t\t\t\tel.removeAttribute(p);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tsetAttr(el, p, JSON.stringify(v), { policy, elementNs });\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport function getBool(el, attr) {\n\treturn el.hasAttribute(attr);\n}\n\nexport function setBool(el, attr, val) {\n\tel.toggleAttribute(attr, val);\n}\n\nexport function getInt(el, attr, {\n\tfallback = NaN,\n\tmin = Number.MIN_SAFE_INTEGER,\n\tmax = Number.MAX_SAFE_INTEGER,\n} = {}) {\n\tif (el.hasAttribute(attr)) {\n\t\tconst val = clamp(min, parseInt(el.getAttribute(attr)), max);\n\t\treturn Number.isNaN(val) ? fallback : val;\n\t} else {\n\t\treturn fallback;\n\t}\n}\n\nexport function setInt(el, attr, val, {\n\tmin = Number.MIN_SAFE_INTEGER,\n\tmax = Number.MAX_SAFE_INTEGER,\n\tpolicy,\n} = {}) {\n\tif (val instanceof Date) {\n\t\tsetAttr(el, attr, val.getTime(), { min, max, policy});\n\t} else if (Number.isInteger(val)) {\n\t\tsetAttr(el, attr, clamp(min, val, max), { policy });\n\t} else if (typeof val === 'string') {\n\t\tsetInt(el, attr, parseInt(val), { min, max });\n\t} else {\n\t\tel.removeAttribute(attr);\n\t}\n}\n\nexport function getFloat(el, attr, {\n\tfallback = NaN,\n\tmin = Number.MIN_SAFE_INTEGER,\n\tmax = Number.MAX_SAFE_INTEGER,\n} = {}) {\n\tif (el.hasAttribute(attr)) {\n\t\tconst val = clamp(min, parseFloat(el.getAttribute(attr)), max);\n\t\treturn Number.isNaN(val) ? fallback : val;\n\t} else {\n\t\treturn fallback;\n\t}\n}\n\nexport function setFloat(el, attr, val, {\n\tmin = Number.MIN_SAFE_INTEGER,\n\tmax = Number.MAX_SAFE_INTEGER,\n\tpolicy,\n} = {}) {\n\tif (typeof val === 'number' && ! Number.isNaN(val)) {\n\t\tsetAttr(el, attr, clamp(min, val, max), { policy });\n\t} else if (typeof val === 'string') {\n\t\tsetFloat(el, attr, parseFloat(val), { min, max });\n\t} else {\n\t\tel.removeAttribute(attr);\n\t}\n}\n\nexport function getString(el, attr, { fallback = null } = {}) {\n\tif (el.hasAttribute(attr)) {\n\t\treturn el.getAttribute(attr) || fallback;\n\t} else {\n\t\treturn fallback;\n\t}\n}\n\nexport function setString(el, attr, val, {\n\tminLength = 1,\n\tmaxLength = Infinity,\n\tpattern   = null,\n\tfallback,\n\tpolicy,\n} = {}) {\n\tif (\n\t\ttypeof val === 'string'\n\t\t&& between(minLength, val.length, maxLength)\n\t\t&& (! (pattern instanceof RegExp) || pattern.test(val))\n\t) {\n\t\tsetAttr(el, attr, val, { policy });\n\t} else if(isTrustedType(val)) {\n\t\tconst str = val.toString();\n\n\t\tif (\n\t\t\tbetween(minLength, str.length, maxLength)\n\t\t\t&& (! (pattern instanceof RegExp) || pattern.test(str))\n\t\t) {\n\t\t\tsetAttr(el, attr, val, { policy });\n\t\t} else {\n\t\t\tel.removeAttribute(attr);\n\t\t}\n\t} else if (typeof fallback === 'string' || isTrustedType(fallback)) {\n\t\tsetString(el, attr, fallback, { pattern, policy, minLength, maxLength });\n\t} else {\n\t\tel.removeAttribute(attr);\n\t}\n}\n\nexport function getURL(el, attr, { base = document.baseURI } = {}) {\n\tif (el.hasAttribute(attr)) {\n\t\treturn new URL(el.getAttribute(attr), base);\n\t} else {\n\t\treturn null;\n\t}\n}\n\nexport function setURL(el, attr, val, {\n\tbase = document.baseURI,\n\trequirePath = false,\n\tpolicy,\n} = {}) {\n\tif ((val instanceof URL) && (! requirePath || val.pathname.length > 1)) {\n\t\tsetAttr(el, attr, val.href, { policy });\n\t} else if (typeof val === 'string' && val.length !== 0) {\n\t\tsetURL(el, attr, new URL(val, base), { requirePath });\n\t} else if (isScriptURL(val)) {\n\t\tconst url = new URL(val.toString(), document.baseURI);\n\n\t\tif (! requirePath || url.pathname.length > 1) {\n\t\t\tsetAttr(el, attr, val, { policy });\n\t\t} else {\n\t\t\tel.removeAttribute(attr);\n\t\t}\n\t} else {\n\t\tel.removeAttribute(attr);\n\t}\n}\n\nexport function getEnum(el, attr, {\n\tallowed  = [],\n\tfallback = undefined,\n}) {\n\tif (! Array.isArray(allowed) || allowed.length === 0) {\n\t\tthrow new TypeError('`allowed` must be a non-empty array.');\n\t} else if (el.hasAttribute(attr)) {\n\t\tconst val = el.getAttribute(attr);\n\t\treturn allowed.includes(val) ? val : fallback;\n\t} else {\n\t\treturn fallback;\n\t}\n}\n\nexport function setEnum(el, attr, val, {\n\tallowed = [],\n\tfallback = undefined,\n}) {\n\tif (! Array.isArray(allowed) || allowed.length === 0) {\n\t\tthrow new TypeError('`allowed` must be a non-empty array.');\n\t} else if (allowed.includes(val)) {\n\t\tsetAttr(el, attr, val);\n\t} else if (! isNullish(fallback)) {\n\t\tsetAttr(el, attr, fallback);\n\t} else {\n\t\tel.removeAttribute(attr);\n\t}\n}\n\nexport function getColor(el, attr, { fallback } = {}) {\n\tconst val = getString(el, attr);\n\treturn typeof val === 'string' && COLOR.test(val) ? val : fallback;\n}\n\nexport function setColor(el, attr, val, { fallback } = {}) {\n\tsetString(el, attr, val, { fallback, minLength: 3, maxLength: 9, pattern: COLOR });\n}\n\nexport function getRGB(el, attr, { fallback = '#000000' } = {}) {\n\tconst { red = 0, green = 0, blue = 0 } = parseHexColor(getColor(el, attr, { fallback }));\n\treturn { red, green, blue };\n}\n\nexport function setRGB(el, attr, { red = 0, green = 0, blue = 0 } = {}) {\n\tsetColor(el, attr, toHexColor({ red, green, blue }));\n}\n\nexport function getRGBA(el, attr, { fallback = '#000000' } = {}) {\n\tconst { red = 0, green = 0, blue = 0, alpha = 1 } = parseHexColor(getColor(el, attr, { fallback }));\n\treturn { red, green, blue, alpha };\n}\n\nexport function setRGBA(el, attr, { red = 0, green = 0, blue = 0, alpha = 1 } = {}) {\n\tsetColor(el, attr, toHexColor({ red, green, blue, alpha }));\n}\n\nexport { setAttr };\n","/**\n * @copyright 2021-2023 Chris Zuber <admin@kernvalley.us>\n */\nimport { signalAborted } from './abort.js';\nimport { addListener, listen } from './events.js';\nimport { getDeferred, isAsync } from './promises.js';\nimport { isHTML, isTrustPolicy } from './trust.js';\nimport { HTML } from './types.js';\nimport { errorToEvent, callOnce, isNullish, isIterable } from './utility.js';\nimport { data as setData, css as setCss, attr as setAttr, aria as setAria } from './attrs.js';\n\nexport const readyStates = ['loading', 'interactive', 'complete'];\n\nexport const readyStateIndex = (state = document.readyState) => readyStates.indexOf(state);\n\nexport const reachedState = state => ! readyStateIndex(document.readyState) > readyStateIndex(state);\n\nexport function query(what, base = document) {\n\tif (Array.isArray(what)) {\n\t\treturn what;\n\t} else if (what instanceof EventTarget) {\n\t\treturn [what];\n\t} else if (typeof what === 'string') {\n\t\tconst matches = Array.from(base.querySelectorAll(what));\n\n\t\tif (base.matches instanceof Function && base.matches(what)) {\n\t\t\tmatches.push(base);\n\t\t}\n\t\treturn matches;\n\t} else if (isIterable(what)) {\n\t\treturn Array.from(what);\n\t} else {\n\t\tthrow new TypeError('Invalid \"what\" given to query()');\n\t}\n}\n\nexport function nth(what, n, { base } = {}) {\n\treturn query(what, base).at(n);\n}\n\nexport function first(what, base) {\n\treturn nth(what, 0, { base });\n}\n\nexport function last(what, base) {\n\treturn nth(what, -1, { base });\n}\n\nexport function each(what, callback, { base } = {}) {\n\tconst items = query(what, base);\n\titems.forEach(callback);\n\treturn items;\n}\n\nexport function map(what, callback, { base } = {}) {\n\treturn query(what, base).map(callback);\n}\n\nexport function some(what, callback, { base } = {}) {\n\treturn query(what, base).some(callback);\n}\n\nexport function every(what, callback, { base } = {}) {\n\treturn query(what, base).every(callback);\n}\n\nexport function find(what, callback, { base } = {}) {\n\treturn query(what, base).find(callback);\n}\n\nexport function filter(what, callback, { base } = {}) {\n\treturn query(what, base).filter(callback);\n}\n\nexport function groupToMap(what, callback, { base } = {}) {\n\treturn query(what, base).groupToMap(callback);\n}\n\nexport function group(what, callback, { base } = {}) {\n\treturn query(what, base).group(callback);\n}\n\nexport function append(parent, ...nodes) {\n\tparent.append(...nodes);\n}\n\nexport function remove(what, { base } = {}) {\n\treturn each(what, item => item.remove(), { base });\n}\n\nexport function meta({ name, itemprop, property, charset, content }) {\n\tconst meta = document.createElement('meta');\n\n\tif (typeof name === 'string') {\n\t\tmeta.name = name;\n\t\tmeta.content = content;\n\t} else if (typeof itemprop === 'string') {\n\t\tmeta.setAttribute('itemprop', itemprop);\n\t\tmeta.content = content;\n\t} else if (typeof property === 'string') {\n\t\tmeta.setAttribute('property', property);\n\t\tmeta.content = content;\n\t} else if (typeof charset === 'string') {\n\t\tmeta.setAttribute('charset', charset);\n\t} else {\n\t\tthrow new Error('Meta must have either name, itemprop, property, or charset given');\n\t}\n\n\treturn meta;\n}\n\nexport function css(what, props = {}, { base, priority } = {}) {\n\treturn each(what, item => setCss(item, props, { priority }), { base });\n}\n\nexport function aria(what, props ={}, { base } = {}) {\n\teach(what, item => setAria(item, props), { base });\n}\n\nexport function data(what, props = {}, { base } = {}) {\n\treturn each(what, item => setData(item, props), { base });\n}\n\nexport function attr(what, props = {}, { base, namespace = null, policy } = {}) {\n\treturn each(what, item => setAttr(item, props, { namespace, policy }), { base });\n}\n\nexport function toggleAttr(what, attrs, { base, force, signal } = {}) {\n\tif (! Array.isArray(attrs)) {\n\t\tattrs = [attrs];\n\t}\n\tconst items = query(what, base);\n\n\tif (! (signal instanceof AbortSignal)) {\n\t\titems.forEach(item => attrs.forEach(attr => item.toggleAttribute(attr, force)));\n\t} else if (signal.aborted) {\n\t\titems.forEach(item => attrs.forEach(attr => item.removeAttribute(attr)));\n\t} else {\n\t\tif (typeof force !== 'boolean') {\n\t\t\tforce = true;\n\t\t}\n\n\t\titems.forEach(item => attrs.forEach(attr => item.toggleAttribute(attr, force)));\n\n\t\tsignal.addEventListener('abort', () => {\n\t\t\titems.forEach(item => attrs.forEach(attr => item.toggleAttribute(attr, !force)));\n\t\t}, { once: true });\n\t}\n\treturn items;\n}\n\nexport function disable(what, { base, value = true } = {}) {\n\treturn each(what, el => el.disabled = value, { base });\n}\n\nexport function enable(what, { base, value = false } = {}) {\n\treturn disable(what, { base, value });\n}\n\nexport function hide(what, { base, value = true } = {}) {\n\treturn each(what, el => el.hidden = value, { base });\n}\n\nexport function unhide(what, { base, value = false } = {}) {\n\treturn hide(what, { base, value });\n}\n\nexport function value(what, value, { base } = {}) {\n\tif (value == null) {\n\t\treturn each(what, el => el.removeAttribute('value'), { base });\n\t} else {\n\t\treturn each(what, el => el.value = value, { base });\n\t}\n}\n\nexport function addClass(what, ...args) {\n\treturn each(what, el => el.classList.add(...args));\n}\n\nexport function removeClass(what, ...args) {\n\treturn each(what, el => el.classList.remove(...args));\n}\n\nexport function toggleClass(what, classes = {}, { base, force } = {}) {\n\treturn each(what, item => {\n\t\tif (typeof classes === 'string') {\n\t\t\treturn item.classList.toggle(classes, force);\n\t\t} else if (Array.isArray(classes)) {\n\t\t\tclasses.forEach(cn => item.classList.toggle(cn, force));\n\t\t} else {\n\t\t\tObject.entries(classes).forEach(([cl, cond]) => {\n\t\t\t\tif (cond instanceof Function) {\n\t\t\t\t\titem.classList.toggle(cl, cond.apply(what, [cl]));\n\t\t\t\t} else if (cond instanceof AbortSignal) {\n\t\t\t\t\tif (cond.aborted) {\n\t\t\t\t\t\titem.classList.remove(cl);\n\t\t\t\t\t} else {\n\t\t\t\t\t\titem.classList.add(cl, true);\n\t\t\t\t\t\tcond.addEventListener('abort', () => {\n\t\t\t\t\t\t\titem.classList.remove(cl);\n\t\t\t\t\t\t}, { once: true });\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\titem.classList.toggle(cl, cond);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}, { base });\n}\n\nexport function replaceClass(what, classes = {}, { base } = {}) {\n\tconst entries = Object.entries(classes);\n\n\treturn each(what, item => {\n\t\tentries.forEach(([from, to]) => item.classList.replace(from, to));\n\t}, { base });\n}\n\nexport function text(what, text, { base } = {}) {\n\treturn each(what, el => el.textContent = text, { base });\n}\n\nexport function html(what, text, {\n\tbase,\n\tsanitizer,\n\tpolicy = 'trustedTypes' in globalThis ? globalThis.trustedTypes.defaultPolicy : undefined,\n} = {}) {\n\tif (typeof sanitizer !== 'undefined' && Element.prototype.setHTML instanceof Function) {\n\t\treturn each(what, el => el.setHTML(text, { sanitizer }), { base });\n\t} else if (isHTML(text)) {\n\t\treturn each(what, el => el.innerHTML = text, { base });\n\t} else if (! isNullish(policy) && policy.createHTML instanceof Function) {\n\t\ttext = policy.createHTML(text);\n\t\treturn each(what, el => el.innerHTML = text, { base });\n\t} else {\n\t\treturn each(what, el => el.innerHTML = text, { base });\n\t}\n}\n\nexport function on(what, when, ...args) {\n\t// @TODO: Figure out a way of adding `base` to arguments\n\tconst items = query(what);\n\n\tif (typeof when === 'string') {\n\t\taddListener(items, [when], ...args);\n\t} else if (Array.isArray(when)) {\n\t\taddListener(items, when, ...args);\n\t} else {\n\t\tObject.entries(when).forEach(([ev, cb]) => addListener(items, [ev], cb, ...args));\n\t}\n\n\treturn items;\n}\n\nexport function prevent(what, event = ['submit'], { signal, capture } = {}) {\n\treturn on(what, event, ev => ev.preventDefault(), { signal, capture });\n}\n\nexport function off(what, when, ...args) {\n\treturn each(what, item => {\n\t\tif (typeof when === 'string') {\n\t\t\titem.removeEventListener(when, ...args);\n\t\t} else if (Array.isArray(when)) {\n\t\t\twhen.forEach(e =>  item.removeEventListener(e, ...args));\n\t\t} else {\n\t\t\tObject.entries(when).forEach(([ev, cb]) => item.removeEventListener(ev, cb, ...args));\n\t\t}\n\t});\n}\n\nexport async function when(what, events, { capture, passive, signal, base } = {}) {\n\tconst controller = new AbortController();\n\tconst { promise, resolve, reject } = getDeferred();\n\n\tif (signal instanceof AbortSignal) {\n\t\tif (signal.aborted) {\n\t\t\tcontroller.abort(signal.reason);\n\t\t} else {\n\t\t\taddEventListener([signal], ['abort'], () => {\n\t\t\t\tcontroller.abort(signal.reason);\n\t\t\t\treject(signal.reason);\n\t\t\t}, { once: true, signal: controller.signal });\n\t\t}\n\t}\n\n\tif (controller.signal.aborted) {\n\t\treject(controller.signal.reason);\n\t} else {\n\t\ton(query(what, base), events, event => {\n\t\t\tresolve(event);\n\t\t\tcontroller.abort();\n\t\t}, { capture, passive, signal: controller.signal });\n\t}\n\n\treturn promise;\n}\n\nexport const ready = callOnce(async function ready({ signal } = {}) {\n\tconst { promise, resolve, reject } = getDeferred();\n\n\tif (signal instanceof AbortSignal && signal.aborted) {\n\t\treject(signal.reason || new DOMException('Operation aborted.'));\n\t} else if (readyStateIndex() === 0) {\n\t\tlisten(document, 'DOMContentLoaded', resolve, { signal, once: true, capture: true });\n\n\t\tif (signal instanceof AbortSignal) {\n\t\t\tsignal.addEventListener('abort',\n\t\t\t\t({ target }) => reject(target.reason || new DOMException('Operation aborted.')),\n\t\t\t\t{ once: true }\n\t\t\t);\n\t\t}\n\t} else {\n\t\tresolve();\n\t}\n\n\treturn promise;\n});\n\nexport async function whenReadyState(state, { signal } = {}) {\n\tconst { resolve, reject, promise } = getDeferred();\n\tconst stateIndex = readyStateIndex(state);\n\n\tif (signal instanceof AbortSignal && signal.aborted) {\n\t\treject(signal.reason || new DOMException('Operation aborted.'));\n\t} else if (stateIndex < 0) {\n\t\treject(new DOMException(`Invalid state: ${state}`));\n\t} else if (stateIndex > readyStateIndex()) {\n\t\tconst controller = new AbortController();\n\t\tlet settled = false;\n\n\t\tcontroller.signal.addEventListener('abort', ({ target }) => {\n\t\t\tif (! settled) {\n\t\t\t\treject(target.reason || new DOMException('Operation aborted.'));\n\t\t\t\tsettled = true;\n\t\t\t}\n\t\t}, { once: true });\n\n\t\tif (signal instanceof AbortSignal) {\n\t\t\tsignal.addEventListener('abort', ({ target }) => {\n\t\t\t\tcontroller.abort(target.reason);\n\t\t\t}, { once: true, signal: controller.signal });\n\t\t}\n\n\t\tdocument.addEventListener('readystatechange', () => {\n\t\t\tif (document.readyState === state) {\n\t\t\t\tresolve();\n\t\t\t\tsettled = true;\n\t\t\t\tcontroller.abort();\n\t\t\t}\n\t\t}, { signal: controller.signal });\n\t} else {\n\t\tresolve();\n\t}\n\n\treturn promise;\n}\n\nexport const interactive =  callOnce(async function interactive({ signal } = {}) {\n\tawait whenReadyState('interactive', { signal });\n});\n\nexport const complete = callOnce(async function complete({ signal } = {}) {\n\tawait whenReadyState('complete', { signal });\n});\n\nexport const loaded =  callOnce(async function loaded({ signal } = {}) {\n\tconst { promise, resolve, reject } = getDeferred();\n\n\tif (signal instanceof AbortSignal && signal.aborted) {\n\t\treject(signal.reason || new DOMException('Operation aborted.'));\n\t} else if (readyStateIndex() < 2) {\n\t\tlisten(globalThis, 'load', resolve, { signal, once: true, capture: true });\n\n\t\tif (signal instanceof AbortSignal) {\n\t\t\tsignal.addEventListener('abort',\n\t\t\t\t({ target }) => reject(target.reason || new DOMException('Operation aborted.')),\n\t\t\t\t{ once: true }\n\t\t\t);\n\t\t}\n\t} else {\n\t\tresolve();\n\t}\n\n\treturn promise;\n});\n\nexport const unloaded = callOnce(async function unloaded({ signal } = {}) {\n\tconst { promise, resolve } = getDeferred();\n\tlisten(globalThis, 'unload', resolve, { signal, once: true, capture: true });\n\treturn promise;\n});\n\nexport const beforeUnload = callOnce(async function beforeUnload({ signal } = {}) {\n\tconst { promise, resolve } = getDeferred({ signal });\n\tlisten(globalThis, 'beforeunload', resolve, { signal, once: true, capture: true });\n\treturn promise;\n});\n\nexport const beforeInstallPrompt = callOnce(async function({ signal } = {}) {\n\tconst { promise, resolve, reject } = getDeferred();\n\n\tif (signal instanceof AbortSignal && signal.aborted) {\n\t\treject(signal.reason);\n\t} else if ('onbeforeinstallprompt' in globalThis) {\n\t\tlisten(globalThis, 'beforeinstallprompt', resolve, { once: true, capture: true, signal });\n\n\t\tif (signal instanceof AbortSignal) {\n\t\t\tlisten(signal, 'abort', ({ reason }) => reject(reason), { once: true });\n\t\t}\n\t}\n\n\treturn await promise;\n});\n\nexport async function whenPageVisible({ signal } = {}) {\n\tconst { promise, resolve } = getDeferred({ signal });\n\n\tif (document.visibilityState === 'visible') {\n\t\tresolve();\n\t} else {\n\t\tlisten(document, 'visibilitychange', () => resolve(), { once: true, signal });\n\t}\n\n\treturn promise;\n}\n\nexport async function whenPageHidden({ signal } = {}) {\n\tconst { promise, resolve } = getDeferred({ signal });\n\n\tif (document.visibilityState === 'hidden') {\n\t\tresolve();\n\t} else {\n\t\tlisten(document, 'visibilitychange', () => resolve(), { once: true, signal });\n\t}\n\n\treturn promise;\n}\n\nexport function parse(text, {\n\ttype = HTML,\n\tasFrag = true,\n\tsanitizer,\n\tpolicy = 'trustedTypes' in globalThis ? globalThis.trustedTypes.defaultPolicy : undefined,\n} = {}) {\n\tconst parser = new DOMParser();\n\n\tif (asFrag) {\n\t\treturn parseAsFragment(text, { sanitizer, policy });\n\t} else if (isTrustPolicy(policy) && ! isHTML(text)) {\n\t\treturn parser.parseFromString(policy.createHTML(text), type);\n\t} else {\n\t\treturn parser.parseFromString(text, type);\n\t}\n}\n\nexport function documentToFragment(doc, { sanitizer } = {}) {\n\tconst clone = doc.cloneNode(true);\n\tconst frag = document.createDocumentFragment();\n\tfrag.append(...clone.head.childNodes, ...clone.body.childNodes);\n\n\treturn typeof sanitizer !== 'undefined' && sanitizer.sanitize instanceof Function\n\t\t? sanitizer.sanitize(frag) : frag;\n}\n\nexport function parseAsFragment(text, {\n\tsanitizer,\n\tpolicy = 'trustedTypes' in globalThis ? globalThis.trustedTypes.defaultPolicy : undefined,\n} = {}) {\n\tconst tmp = document.createElement('template');\n\n\tif (isTrustPolicy(policy) && ! isHTML(text)) {\n\t\ttmp.innerHTML = policy.createHTML(text);\n\t} else {\n\t\ttmp.innerHTML = text;\n\t}\n\n\treturn typeof sanitizer !== 'undefined' && sanitizer.sanitize instanceof Function\n\t\t? sanitizer.sanitize(tmp.content)\n\t\t: tmp.content;\n}\n\nexport function animate(what, keyframes, opts = { duration: 400, base: document.body }) {\n\tif (opts.signal instanceof AbortSignal && opts.signal.aborted) {\n\t\tthrow opts.signal.reason;\n\t} else if (! (Element.prototype.animate instanceof Function)) {\n\t\tthrow new DOMException('Animations not supported');\n\t} else {\n\t\tif (Number.isInteger(opts)) {\n\t\t\topts = { duration: opts };\n\t\t}\n\n\t\tconst animations = query(what, opts.base).map(item => item.animate(keyframes, opts));\n\n\t\tif (opts.signal instanceof AbortSignal) {\n\t\t\topts.signal.addEventListener('abort', () => animations.forEach(anim => anim.cancel()), { once: true });\n\t\t}\n\n\t\tif (opts.resolve instanceof Function) {\n\t\t\tPromise.allSettled(animations.map(anim => anim.finished))\n\t\t\t\t.then(proms => opts.resolve(proms.group(({ status }) => status)));\n\t\t}\n\n\t\treturn animations;\n\t}\n}\n\nexport function intersect(what, callback, { root, rootMargin, signal, threshold } = {}) {\n\tif (signal instanceof AbortSignal && signal.aborted) {\n\t\tthrow signal.reason;\n\t} else if (! ('IntersectionObserver' in globalThis)) {\n\t\tthrow new DOMException('IntersectionObserver not supported');\n\t} else {\n\t\tconst observer = new IntersectionObserver((entries, observer) => {\n\t\t\tentries.forEach((entry, index) => callback.apply(null, [entry, observer, index]));\n\t\t}, { root, rootMargin, threshold });\n\n\t\teach(what, item => observer.observe(item));\n\n\t\tif (signal instanceof AbortSignal) {\n\t\t\tsignalAborted(signal).finally(() => observer.disconnect());\n\t\t}\n\n\t\treturn observer;\n\t}\n}\n\nexport function mutate(what, callback, options = {}) {\n\tif ('MutationObserver' in globalThis) {\n\t\tconst observer = new MutationObserver((records, observer) => {\n\t\t\trecords.forEach((record, index) => callback.apply(null, [record, observer, index]));\n\t\t});\n\n\t\teach(what, item => observer.observe(item, options));\n\n\t\tif (options.signal instanceof AbortSignal) {\n\t\t\tsignalAborted(options.signal).finally(() => observer.disconnect());\n\t\t}\n\n\t\treturn observer;\n\t} else {\n\t\tthrow new Error('MutationObserver not supported');\n\t}\n}\n\nexport function stripComments(node) {\n\tif (! (node instanceof Node)) {\n\t\tthrow new TypeError('Cannot strip comments from non-node');\n\t} else {\n\t\tswitch(node.nodeType) {\n\t\t\tcase Node.ELEMENT_NODE:\n\t\t\tcase Node.DOCUMENT_NODE:\n\t\t\tcase Node.DOCUMENT_FRAGMENT_NODE:\n\t\t\t\tif (node.hasChildNodes()) {\n\t\t\t\t\t[...node.childNodes].forEach(stripComments);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase Node.COMMENT_NODE:\n\t\t\t\tnode.remove();\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport function supportsElement(...tags) {\n\treturn ! tags.some(tag => document.createElement(tag) instanceof HTMLUnknownElement);\n}\n\nexport function createTable(data, { caption, header, footer } = {}) {\n\tconst table = document.createElement('table');\n\tif (Array.isArray(data)) {\n\t\tdata.forEach(row => {\n\t\t\tif (Array.isArray(row)) {\n\t\t\t\tconst tr = table.insertRow();\n\t\t\t\trow.forEach(cell => tr.insertCell().textContent = cell);\n\t\t\t}\n\t\t});\n\t}\n\n\tif (Array.isArray(header)) {\n\t\tconst tHead = table.createTHead();\n\t\tconst row = tHead.insertRow();\n\t\trow.append(...header.map(cell => {\n\t\t\tconst th = document.createElement('th');\n\t\t\tth.scope = 'col';\n\t\t\tth.textContent = cell;\n\t\t\treturn th;\n\t\t}));\n\t}\n\n\tif (Array.isArray(footer)) {\n\t\tconst tFoot = table.createTFoot();\n\t\tconst row = tFoot.insertRow();\n\t\trow.append(...footer.map(cell => {\n\t\t\tconst th = document.createElement('th');\n\t\t\tth.textContent = cell;\n\t\t\treturn th;\n\t\t}));\n\t}\n\n\tif (typeof caption === 'string') {\n\t\ttable.createCaption().textContent = caption;\n\t}\n\n\treturn table;\n}\n\nexport { addListener, isAsync, errorToEvent };\n","/**\n * @copyright 2023 Chris Zuber <admin@kernvalley.us>\n */\nconst symbols = { resp: Symbol('resp') };\n\nexport class HTTPException extends Error {\n\tconstructor(resp = Response.error(), { message, cause } = {}) {\n\t\tsuper(\n\t\t\ttypeof message === 'string' ? message :`<${resp.url}> [${resp.status} ${resp.statusText}]`,\n\t\t\t{ cause }\n\t\t);\n\n\t\tObject.defineProperty(this, symbols.resp, {\n\t\t\tvalue: resp,\n\t\t\tconfigurable: false,\n\t\t\twritable: false,\n\t\t\tenumerable: false,\n\t\t});\n\t}\n\n\tasync json() {\n\t\treturn await this[symbols.resp].json();\n\t}\n\n\tasync text() {\n\t\treturn await this[symbols.resp].text();\n\t}\n\n\tget body() {\n\t\treturn this[symbols.resp].body;\n\t}\n\n\tget bodyUsed() {\n\t\treturn this[symbols.resp].bodyUsed;\n\t}\n\n\tget headers() {\n\t\treturn this[symbols.resp].headers;\n\t}\n\n\tget ok() {\n\t\treturn this[symbols.resp].ok;\n\t}\n\n\tget redirected() {\n\t\treturn this[symbols.resp].redirected;\n\t}\n\n\tget status() {\n\t\treturn this[symbols.resp].status;\n\t}\n\n\tget statusText() {\n\t\treturn this[symbols.resp].statusText;\n\t}\n\n\tget type() {\n\t\treturn this[symbols.resp].type;\n\t}\n\n\tget url() {\n\t\treturn this[symbols.resp].url;\n\t}\n\n\ttoJSON() {\n\t\tconst { status, statusText, ok, url, message, type, redirected } = this;\n\t\treturn { status, ok, statusText, url, message, type, redirected };\n\t}\n}\n","/**\n * @copyright 2021-2023 Chris Zuber <admin@kernvalley.us>\n */\nimport { parse } from './dom.js';\nimport { signalAborted } from './abort.js';\nimport { setURLParams, setUTMParams, isObject, isNullish, callOnce } from './utility.js';\nimport { isTrustPolicy } from './trust.js';\nimport { HTTPException } from './HTTPException.js';\nimport * as TYPES from './types.js';\n\nfunction filename(src) {\n\tif (typeof src === 'string') {\n\t\treturn new URL(src, location.origin).pathname.split('/').at(-1);\n\t} else {\n\t\treturn '';\n\t}\n}\n\nfunction getType({ headers }) {\n\tif (headers instanceof Headers && headers.has('Content-Type')) {\n\t\treturn headers.get('Content-Type').split(';')[0];\n\t} else {\n\t\treturn null;\n\t}\n}\n\nfunction handleResponse(resp, { cause, message } = {}) {\n\tif (! (resp instanceof Response)) {\n\t\tthrow new TypeError('Expected a Response object');\n\t} else if (! resp.ok) {\n\t\tthrow new HTTPException(resp, { cause, message });\n\t} else {\n\t\treturn resp;\n\t}\n}\n\nfunction handleError(err) {\n\tif (err instanceof HTTPException) {\n\t\tthrow err;\n\t} else if (err instanceof Error) {\n\t\tthrow new HTTPException(Response.error(), { cause: err, message: err.message });\n\t} else if (typeof err === 'string') {\n\t\tthrow new HTTPException(Response.error(), {\n\t\t\tcause: new DOMException('Unknown network error'),\n\t\t\tmessage: err,\n\t\t});\n\t} else {\n\t\tthrow new HTTPException(Response.error(), {\n\t\t\tcause: new DOMException('Unknown network error'),\n\t\t\tmessage: 'Unknown network error',\n\t\t});\n\t}\n}\n\nexport async function fetch(url, opts = {}) {\n\tif (opts.signal instanceof AbortSignal && opts.signal.aborted) {\n\t\tthrow new HTTPException(Response.error(), {\n\t\t\tcause: opts.signal.reason,\n\t\t\tmessage: opts.signal.reason instanceof Error ? opts.signal.reason.message : opts.signal.reason,\n\t\t});\n\t} else if (opts.signal instanceof AbortSignal && ! ('signal' in Request.prototype)) {\n\t\treturn await Promise.race([\n\t\t\tglobalThis.fetch(url, opts),\n\t\t\tsignalAborted(opts.signal),\n\t\t]).then(resp => handleResponse(resp, { message: opts.errorMessage }), handleError);\n\t} else {\n\t\treturn await globalThis.fetch(url, opts).then(resp => handleResponse(resp, { message: opts.errorMessage }), handleError);\n\t}\n}\n\nexport const getHTTPCSP = callOnce(async function getHTTPCSP() {\n\tconst { ok, headers } = await fetch(location.href, { method: 'HEAD' });\n\n\tif (ok && headers.has('Content-Security-Policy')) {\n\t\tconst directives = headers.get('Content-Security-Policy').trim().split(';').filter(str => str.length !== 0);\n\n\t\treturn Object.fromEntries(directives.map(directive => {\n\t\t\tconst [key, ...rest] = directive.trim().split(' ').filter(part => part.length !== 0);\n\t\t\treturn [key, rest];\n\t\t}));\n\t}\n});\n\nexport const getCSP = callOnce(async function getCSP() {\n\ttry {\n\t\tconst csp = await getHTTPCSP();\n\n\t\tif (typeof csp === 'object' && ! Object.is(csp, null)) {\n\t\t\treturn csp;\n\t\t} else {\n\t\t\treturn getMetaCSP();\n\t\t}\n\t} catch(err) {\n\t\tconsole.error(err);\n\t\treturn getMetaCSP();\n\t}\n});\n\nexport function getMetaCSP() {\n\tconst meta = document.head.querySelector('meta[http-equiv=\"Content-Security-Policy\"][content]');\n\n\tif (meta instanceof HTMLMetaElement) {\n\t\tconst directives = meta.content.trim().split(';').filter(str => str.length !== 0);\n\n\t\treturn Object.fromEntries(directives.map(directive => {\n\t\t\tconst [key, ...rest] = directive.trim().split(' ').filter(part => part.length !== 0);\n\t\t\treturn [key, rest];\n\t\t}));\n\t} else {\n\t\treturn {};\n\t}\n}\n\nexport async function GET(url, {\n\tbody = undefined,\n\tmode = 'cors',\n\tcache = 'default',\n\tcredentials = 'omit',\n\tredirect = 'follow',\n\tpriority  ='auto',\n\treferrerPolicy = 'no-referrer',\n\theaders = new Headers(),\n\tintegrity = undefined,\n\tkeepalive = undefined,\n\tsignal = undefined,\n\ttimeout = null,\n\terrorMessage,\n} = {}) {\n\tif (typeof body !== 'undefined') {\n\t\turl = setURLParams(url, body);\n\t} else if (typeof url === 'string') {\n\t\turl = new URL(url, document.baseURI);\n\t}\n\n\tif (typeof signal === 'undefined' && Number.isInteger(timeout)) {\n\t\tsignal = AbortSignal.timeout(timeout);\n\t} else if (signal instanceof AbortController) {\n\t\tsignal = signal.signal;\n\t}\n\n\treturn await fetch(url, { method: 'GET', mode, credentials, referrerPolicy,\n\t\theaders, cache, redirect, priority, integrity, keepalive, signal, errorMessage });\n}\n\nexport async function POST(url, {\n\tbody = undefined,\n\tmode = 'cors',\n\tcache = 'default',\n\tcredentials = 'omit',\n\tpriority = 'auto',\n\tredirect = 'follow',\n\treferrerPolicy = 'no-referrer',\n\theaders = new Headers(),\n\tintegrity = undefined,\n\tkeepalive = undefined,\n\tsignal = undefined,\n\ttimeout = null,\n\terrorMessage,\n} = {}) {\n\tif (typeof body === 'object' && ! (body instanceof FormData)) {\n\t\tif (body instanceof HTMLFormElement) {\n\t\t\tbody = new FormData(body);\n\t\t} else if (body instanceof File) {\n\t\t\tlet file;\n\t\t\t[body, file] = [new FormData(), body];\n\t\t\t// @TODO figure out a default param name for the file\n\t\t\t// @TODO handle multiple files and arrays containing files\n\t\t\tbody.set(file.name, file, file.name);\n\t\t} else {\n\t\t\tbody = JSON.stringify(body);\n\n\t\t\tif (headers instanceof Headers && ! headers.has('Content-Type')) {\n\t\t\t\theaders.set('Content-Type', TYPES.JSON);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (typeof signal === 'undefined' && Number.isInteger(timeout)) {\n\t\tsignal = AbortSignal.timeout(timeout);\n\t} else if (signal instanceof AbortController) {\n\t\tsignal = signal.signal;\n\t}\n\n\treturn await fetch(url, { method: 'POST', body, mode, credentials, referrerPolicy,\n\t\theaders, cache, redirect, priority, integrity, keepalive, signal, errorMessage });\n}\n\nexport async function DELETE(url, {\n\tbody = undefined,\n\tmode = 'cors',\n\tcache = 'default',\n\tcredentials = 'omit',\n\tredirect = 'follow',\n\tpriority = 'auto',\n\treferrerPolicy = 'no-referrer',\n\theaders = new Headers(),\n\tintegrity = undefined,\n\tkeepalive = undefined,\n\tsignal = undefined,\n\ttimeout = null,\n\terrorMessage,\n} = {}) {\n\tif (typeof body !== 'undefined') {\n\t\turl = setURLParams(url, body);\n\t} else if (typeof url === 'string') {\n\t\turl = new URL(url, document.baseURI);\n\t}\n\n\tif (typeof signal === 'undefined' && Number.isInteger(timeout)) {\n\t\tsignal = AbortSignal.timeout(timeout);\n\t} else if (signal instanceof AbortController) {\n\t\tsignal = signal.signal;\n\t}\n\n\treturn await fetch(url, { method: 'DELETE', mode, credentials, referrerPolicy,\n\t\theaders, cache, redirect, priority, integrity, keepalive, signal, errorMessage });\n}\n\nexport async function getHTML(url, {\n\tbody = undefined,\n\tmode = 'cors',\n\tcache = 'default',\n\tcredentials = 'omit',\n\tredirect = 'follow',\n\tpriority = 'auto',\n\treferrerPolicy = 'no-referrer',\n\theaders = new Headers({ Accept: TYPES.HTML }),\n\tintegrity = undefined,\n\tkeepalive = undefined,\n\tsignal = undefined,\n\ttimeout = null,\n\thead = true,\n\tasFrag = true,\n\tsanitizer = undefined,\n\tpolicy,\n\terrorMessage,\n} = {}) {\n\tconst html = await getText(url, { body, mode, credentials, referrerPolicy, headers,\n\t\tcache, redirect, priority, integrity, keepalive, signal, timeout, errorMessage });\n\n\tif (isTrustPolicy(policy)) {\n\t\treturn parse(policy.createHTML(html), { asFrag, head });\n\t} else {\n\t\treturn parse(html, { head, asFrag, sanitizer, policy });\n\t}\n}\n\nexport const createTemplateGetter = (...args) => callOnce(() => getHTML(...args));\n\nexport async function getText(url, {\n\tbody = undefined,\n\tmode = 'cors',\n\tcache = 'default',\n\tcredentials = 'omit',\n\tredirect = 'follow',\n\tpriority = 'auto',\n\treferrerPolicy = 'no-referrer',\n\theaders = new Headers({ Accept: TYPES.TEXT }),\n\tintegrity = undefined,\n\tkeepalive = undefined,\n\tsignal = undefined,\n\ttimeout = null,\n\terrorMessage,\n} = {}) {\n\tconst resp = await GET(url, { body, mode, credentials, referrerPolicy, headers,\n\t\tcache, redirect, priority, integrity, keepalive, signal, timeout, errorMessage });\n\n\treturn await resp.text();\n}\n\nexport async function getJSON(url, {\n\tbody = undefined,\n\tmode = 'cors',\n\tcache = 'default',\n\tcredentials = 'omit',\n\tredirect = 'follow',\n\treferrerPolicy = 'no-referrer',\n\tpriority = 'auto',\n\theaders = new Headers({ Accept: TYPES.JSON }),\n\tintegrity = undefined,\n\tkeepalive = undefined,\n\tsignal = undefined,\n\ttimeout = null,\n\terrorMessage,\n} = {}) {\n\tconst resp = await GET(url, { body, mode, credentials, referrerPolicy, headers,\n\t\tcache, redirect, priority, integrity, keepalive, signal, timeout, errorMessage });\n\n\treturn await resp.json();\n}\n\nexport async function getFile(url, {\n\tname = null,\n\tbody = undefined,\n\tmode = 'cors',\n\tcache = 'default',\n\tcredentials = 'omit',\n\tredirect = 'follow',\n\treferrerPolicy = 'no-referrer',\n\tpriority = 'auto',\n\theaders = new Headers(),\n\tintegrity = undefined,\n\tkeepalive = undefined,\n\tsignal = undefined,\n\ttimeout = null,\n\terrorMessage,\n} = {}) {\n\tif (typeof name !== 'string') {\n\t\tname = filename(url);\n\t}\n\n\tconst resp = await GET(url, { body, mode, credentials, referrerPolicy, headers,\n\t\tcache, redirect, priority, integrity, keepalive, signal, timeout, errorMessage });\n\n\tconst type = getType(resp);\n\treturn new File([await resp.blob()], name, { type });\n}\n\nexport async function submitForm(form) {\n\tif (typeof form === 'string') {\n\t\treturn await submitForm(document.forms[form]);\n\t} else if (form instanceof Event) {\n\t\tform.preventDefault();\n\t\treturn await submitForm(form.target);\n\t} else if (form instanceof HTMLFormElement) {\n\t\tswitch (form.method.toLowerCase()) {\n\t\t\tcase 'get':\n\t\t\t\treturn GET(form.action, { body: new FormData(form) });\n\n\t\t\tcase 'post':\n\t\t\t\treturn POST(form.action, { body: new FormData(form) });\n\n\t\t\tcase 'delete':\n\t\t\t\treturn DELETE(form.action, { body: new FormData(form) });\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error(`Unsupported method: ${form.method}`);\n\t\t}\n\t}\n}\n\nexport const getManifest = callOnce(async function getManifest({ timeout, signal } = {}) {\n\tconst resp = await getLink('link[rel=\"manifest\"][href]', { timeout, signal });\n\treturn await resp.json();\n});\n\nexport async function getLink(link, { timeout, signal } = {}) {\n\tif (typeof link === 'string') {\n\t\treturn await getLink(document.querySelector(link, { timeout, signal }));\n\t} else if (! (link instanceof HTMLLinkElement)) {\n\t\tthrow new DOMException('Expected a <link>');\n\t} else if (link.href.length === 0) {\n\t\tthrow new DOMException('Missing `href` on <link>');\n\t} else {\n\t\tconst { href, integrity, type, referrerPolicy, crossOrigin } = link;\n\n\t\tlet credentials;\n\t\tconst mode = typeof crossOrigin === 'string' ? 'cors' : 'no-cors';\n\t\tconst headers = new Headers();\n\n\t\tif (mode === 'cors') {\n\t\t\tcredentials = crossOrigin === 'use-credentials' ? 'include' : 'omit';\n\t\t}\n\n\t\tif (typeof type === 'string') {\n\t\t\theaders.set('Accept', type);\n\t\t}\n\n\t\treturn await GET(href, { mode, credentials, headers, integrity, referrerPolicy, timeout, signal });\n\t}\n}\n\nexport async function postHTML(url, {\n\tbody = undefined,\n\tmode = 'cors',\n\tcache = 'default',\n\tcredentials = 'omit',\n\tredirect = 'follow',\n\treferrerPolicy = 'no-referrer',\n\tpriority = 'auto',\n\theaders = new Headers({ Accept: TYPES.HTML }),\n\tintegrity = undefined,\n\tkeepalive = undefined,\n\tsignal = undefined,\n\ttimeout = null,\n\thead = true,\n\tasFrag = true,\n\tsanitizer = undefined,\n\tpolicy,\n\terrorMessage,\n} = {}) {\n\tconst html = await postText(url, { body, mode, credentials, referrerPolicy, headers,\n\t\tcache, redirect, priority, integrity, keepalive, signal, timeout, errorMessage });\n\n\treturn parse(html, { head, asFrag, sanitizer, policy });\n}\n\nexport async function postJSON(url, {\n\tbody = undefined,\n\tmode = 'cors',\n\tcache = 'default',\n\tcredentials = 'omit',\n\tredirect = 'follow',\n\treferrerPolicy = 'no-referrer',\n\tpriority = 'auto',\n\theaders = new Headers({ Accept: TYPES.JSON }),\n\tintegrity = undefined,\n\tkeepalive = undefined,\n\tsignal = undefined,\n\ttimeout = null,\n\terrorMessage,\n} = {}) {\n\tconst resp = await POST(url, { body, mode, credentials, referrerPolicy, headers,\n\t\tcache, redirect, priority, integrity, keepalive, signal, timeout, errorMessage });\n\n\treturn await resp.json();\n}\n\nexport async function postText(url, {\n\tbody = undefined,\n\tmode = 'cors',\n\tcache = 'default',\n\tcredentials = 'omit',\n\tredirect = 'follow',\n\treferrerPolicy = 'no-referrer',\n\tpriority = 'auto',\n\theaders = new Headers({ Accept: TYPES.TEXT }),\n\tintegrity = undefined,\n\tkeepalive = undefined,\n\tsignal = undefined,\n\ttimeout = null,\n\terrorMessage,\n} = {}) {\n\tconst resp = await POST(url, { body, mode, credentials, referrerPolicy, headers,\n\t\tcache, redirect, priority, integrity, keepalive, signal, timeout, errorMessage });\n\n\treturn await resp.text();\n}\n\nexport function navigateTo(to, {\n\tparams = {},\n\tutm: {\n\t\tsource: utm_source,\n\t\tmedium: utm_medium = 'referral',\n\t\tcontent: utm_content,\n\t\tcampaign: utm_campaign,\n\t\tterm: utm_term,\n\t} = {},\n\tallowedOrigins = [],\n\trequirePath = false,\n\torigin = location.origin,\n} = {}) {\n\tconst url = new URL(to, origin);\n\n\tif (! Array.isArray(allowedOrigins)) {\n\t\tthrow new TypeError('`allowedOrigins` must be an array');\n\t} else if (! (url.origin === location.origin || allowedOrigins.includes(url.origin))) {\n\t\tthrow new TypeError(`${url.origin} is not an allowed origin`);\n\t} else if (requirePath && url.pathname.length === 1) {\n\t\tthrow new TypeError('`pathname` is required');\n\t} else if (! isObject(params)) {\n\t\tthrow new TypeError('Expected `params` to be an object');\n\t} else {\n\t\tif (typeof utm_source === 'string') {\n\t\t\tObject.entries({...params, utm_source, utm_medium, utm_content, utm_campaign, utm_term })\n\t\t\t\t.filter(([,v]) => ! isNullish(v))\n\t\t\t\t.forEach(([k, v]) => url.searchParams.set(k, v));\n\t\t} else {\n\t\t\tObject.entries(params)\n\t\t\t\t.filter(([,v]) => ! isNullish(v))\n\t\t\t\t.forEach(([k, v]) => url.searchParams.set(k, v));\n\t\t}\n\n\t\tlocation.href = url.href;\n\t}\n}\n\nexport function postNav(url, data = {}, {\n\ttarget = '_self' ,\n\tenctype = TYPES.FORM_URL_ENCODED,\n\tsignal,\n} = {}) {\n\tif (! (signal instanceof AbortSignal && signal.aborted)) {\n\t\tconst form = document.createElement('form');\n\t\tconst inputs = Object.entries(data).map(([name, value]) => {\n\t\t\tconst input = document.createElement('input');\n\t\t\tinput.name = name;\n\t\t\tinput.type = 'hidden';\n\t\t\tinput.readOnly = true;\n\t\t\tinput.value = value;\n\t\t\treturn input;\n\t\t});\n\n\t\tform.action = url;\n\t\tform.method = 'POST';\n\t\tform.target = target;\n\t\tform.enctype = enctype;\n\t\tform.hidden = true;\n\t\tform.append(...inputs);\n\t\tform.addEventListener('submit', ({ target }) => setTimeout(() => target.remove(), 100), { signal });\n\n\t\trequestAnimationFrame(() => {\n\t\t\tdocument.body.append(form);\n\t\t\tform.submit();\n\t\t});\n\t}\n}\n\nexport { setURLParams, setUTMParams };\n","/**\n * @copyright 2023 Chris Zuber <admin@kernvalley.us>\n */\nimport { getJSON } from '../http.js';\n\nexport const events = new URL('https://events.kernvalley.us/events.json');\n\nexport const getEvents = async ({ signal } = {}) => getJSON(events, { signal });\n","/**\n * @copyright 2023 Chris Zuber <admin@kernvalley.us>\n */\nexport const supported = window.customElements instanceof Object;\n\nexport function isDefined(...tags) {\n\treturn supported && tags.every(tag => typeof customElements.get(tag) !== 'undefined');\n}\n\nexport function registerCustomElement(tag, cls, ...rest) {\n\tif (! supported) {\n\t\tconsole.error(new Error('`customElements` not supported'));\n\t\treturn false;\n\t} else if (isDefined(tag)) {\n\t\tconsole.warn(new Error(`<${tag}> is already defined`));\n\t\t// Returns true/false if element being registered matches given class\n\t\treturn customElements.get(tag) === cls;\n\t} else {\n\t\tcustomElements.define(tag, cls, ...rest);\n\t\treturn true;\n\t}\n}\n\nexport async function getCustomElement(tag) {\n\tif (supported) {\n\t\tawait customElements.whenDefined(tag);\n\t\treturn customElements.get(tag);\n\t} else {\n\t\tthrow new Error('`customElements` not supported');\n\t}\n}\n\nexport async function createCustomElement(tag, ...args) {\n\tconst Pro = await getCustomElement(tag);\n\treturn new Pro(...args);\n}\n\nexport async function whenDefined(...els) {\n\tif (supported) {\n\t\tawait Promise.all(els.map(el => customElements.whenDefined(el)));\n\t} else {\n\t\tthrow new Error('`customElements` not supported');\n\t}\n}\n\nexport async function defined(...els) {\n\tconsole.error('`defined()` is deprecated. Please use `whenDefined()` instead');\n\tawait whenDefined(...els);\n}\n","/**\n * @copyright 2023 Chris Zuber <admin@kernvalley.us>\n */\nimport { data, attr, css, getAttrs, aria as setAria } from './attrs.js';\nimport { listen } from './events.js';\nimport { getDeferred } from './promises.js';\nimport { setProp } from './trust.js';\nimport { REFERRER_POLICY } from './defaults.js';\nimport { isObject, isNullish, isIterable } from './utility.js';\nimport { JS } from './types.js';\nimport { isScriptURL, isHTML } from './trust.js';\n\nexport function copyAs(target, tag, {\n\tincludeAttributes = true,\n\tincludeChildren = true,\n\tincludeId = true,\n\tdeep = true,\n\tis,\n} = {}) {\n\tif (typeof tag !== 'string') {\n\t\tthrow new TypeError(`Expected tag to be a string but got a ${typeof tag}`);\n\t} else if (typeof target === 'string') {\n\t\treturn copyAs(document.querySelector(target), tag, { includeAttributes, includeChildren, includeId, deep });\n\t} else if (! (target instanceof Element)) {\n\t\tthrow new TypeError(`Expected target to be a string or Element but got a ${typeof target}`);\n\t} else {\n\t\tconst el = document.createElement(tag, { is });\n\n\t\tif (includeAttributes && target.hasAttributes()) {\n\t\t\tObject.entries(getAttrs(target))\n\t\t\t\t.forEach(([name, value]) => el.setAttribute(name, value));\n\n\t\t\tif (! includeId) {\n\t\t\t\tel.removeAttribute('id');\n\t\t\t}\n\t\t}\n\n\t\tif (includeChildren && target.hasChildNodes()) {\n\t\t\tel.append(...[...target.childNodes].map(node => node.cloneNode(deep)));\n\t\t}\n\n\t\treturn el;\n\t}\n}\n\nexport function createElement(tag, {\n\t/* structured data attributes        */\n\t'@context':    context    = 'https://schema.org',\n\t'@type':       type       = undefined,\n\t'@identifier': identifier = undefined,\n\titemtype                  = undefined,\n\titemprop                  = undefined,\n\titemscope                 = undefined,\n\titemref                   = undefined,\n\titemid                    = undefined,\n\n\t/* Global attributes                  */\n\tid                        = undefined,\n\tclassList                 = undefined,\n\thidden                    = undefined,\n\tdataset                   = undefined,\n\taccessKey                 = undefined,\n\ttitle                     = undefined,\n\n\t/* custom element attributes          */\n\tpart                      = undefined,\n\tslot                      = undefined,\n\tis                        = undefined,\n\n\t/* non-attribute stuff / other        */\n\tchildren                  = undefined,\n\tstyles                    = undefined,\n\ttext                      = undefined,\n\thtml                      = undefined,\n\tpolicy                    = 'trustedTypes' in globalThis ? globalThis.trustedTypes.defaultPolicy : null,\n\tsanitizer                 = undefined,\n\taria                      = undefined,\n\tevents: { capture, passive, once, signal, ...events } = {},\n\tanimation: {\n\t\tkeyframes,\n\t\tduration = 0,\n\t\tdelay = 0,\n\t\tendDelay = 0,\n\t\teasing = 'linear',\n\t\tdirection = 'normal',\n\t\tfill = 'none',\n\t\titerations = 1,\n\t\titerationStart = 0,\n\t\tcomposite = 'replace',\n\t\titerationComposite = 'replace',\n\t\tpseudoElement,\n\t} = {},\n\t...attrs\n} = {}) {\n\tif (typeof tag !== 'string') {\n\t\tthrow new TypeError('tag must be a string');\n\t} else {\n\t\tconst el = document.createElement(tag, { is });\n\t\tel.hidden = hidden;\n\n\t\tif (typeof title === 'string') {\n\t\t\tel.title = title;\n\t\t}\n\n\t\tif (typeof id === 'string') {\n\t\t\tel.id = id;\n\t\t} else if (typeof identifier === 'string') {\n\t\t\tel.id = identifier;\n\t\t}\n\n\t\tif (Array.isArray(classList) && classList.length !== 0) {\n\t\t\tel.classList.add(...classList);\n\t\t}\n\n\t\tif (isObject(dataset)) {\n\t\t\tdata(el, dataset);\n\t\t}\n\n\t\tif (Array.isArray(part) && part.length !== 0) {\n\t\t\tel.part.add(...part);\n\t\t} else if(typeof part === 'string') {\n\t\t\tel.part.add(part);\n\t\t}\n\n\t\tif (typeof slot === 'string') {\n\t\t\tel.slot = slot;\n\t\t}\n\n\t\tif (isObject(styles)) {\n\t\t\tcss(el, styles);\n\t\t}\n\n\t\tObject.entries(events).forEach(([event, callback]) => {\n\t\t\tlisten(el, event, callback, { capture, passive, once, signal });\n\t\t});\n\n\t\tif (typeof text === 'string') {\n\t\t\tel.textContent = text;\n\t\t} else if (typeof html === 'string' || isHTML(html)) {\n\t\t\tif (\n\t\t\t\t'Sanitizer' in globalThis\n\t\t\t\t&& sanitizer instanceof globalThis.Sanitizer\n\t\t\t\t&& Element.prototype.setHTML instanceof Function\n\t\t\t) {\n\t\t\t\tel.setHTML(html, { sanitizer });\n\t\t\t} else {\n\t\t\t\tsetProp(el, 'innerHTML', html, { policy });\n\t\t\t}\n\t\t}\n\n\t\tif (isIterable(children)) {\n\t\t\tel.append(...children.filter(el => typeof el === 'string' || el instanceof Element));\n\t\t}\n\n\t\tif (typeof is === 'string') {\n\t\t\tattrs.is = is;\n\t\t}\n\n\t\tif (typeof itemtype === 'string') {\n\t\t\tattrs.itemtype = itemtype;\n\t\t} else if (typeof type === 'string') {\n\t\t\tattrs.itemtype = new URL(type, context).href;\n\t\t}\n\n\t\tif (typeof itemprop === 'string') {\n\t\t\tattrs.itemprop = itemprop;\n\t\t} else if (Array.isArray(itemprop)) {\n\t\t\tattrs.itemprop = itemprop.join(' ');\n\t\t}\n\n\t\tif (typeof itemref === 'string') {\n\t\t\tattrs.itemref = itemref;\n\t\t} else if (Array.isArray(itemref)) {\n\t\t\tattrs.itemref = itemref.join(' ');\n\t\t}\n\n\t\tif (typeof itemscope === 'boolean' || typeof itemscope === 'string') {\n\t\t\tattrs.itemscope = itemscope;\n\t\t} else if (attrs.hasOwnProperty('itemtype')) {\n\t\t\tattrs.itemscope = true;\n\t\t}\n\n\t\tif (typeof itemid === 'string') {\n\t\t\tattrs.itemid = itemid;\n\t\t}\n\n\t\tif (Array.isArray(accessKey)) {\n\t\t\tel.accessKey = accessKey.join(' ');\n\t\t} else if (typeof accesskey === 'string') {\n\t\t\tel.accessKey = accessKey;\n\t\t}\n\n\t\tattr(el, attrs);\n\n\t\tif (isObject(aria)) {\n\t\t\tsetAria(el, aria);\n\t\t}\n\n\t\tif ((Array.isArray(keyframes) || isObject(keyframes)) && el.animate instanceof Function) {\n\t\t\tel.animate(keyframes, {\n\t\t\t\tduration, delay, endDelay, easing, direction, fill, iterations,\n\t\t\t\titerationStart, composite, iterationComposite, pseudoElement,\n\t\t\t});\n\t\t}\n\n\t\treturn el;\n\t}\n}\n\nexport function createSlot(name, {\n\tid        = undefined,\n\tclassList = undefined,\n\thidden    = undefined,\n\tdataset   = undefined,\n\tchildren  = undefined,\n\tstyles    = undefined,\n\ttext      = undefined,\n\thtml      = undefined,\n\tpolicy    = undefined,\n\tsanitizer = undefined,\n\tevents: { capture, passive, once, signal, ...events } = {},\n\t...attrs\n} = {}) {\n\tconst slot = createElement('slot', {\n\t\tid, classList, hidden, dataset, children, styles, text, html, policy,\n\t\tsanitizer, events: { capture, passive, once, signal, ...events }, ...attrs,\n\t});\n\n\tslot.name = name;\n\treturn slot;\n}\n\nexport function createScript(src, {\n\tasync = true,\n\tdefer = false,\n\tblocking = null,\n\tintegrity = null,\n\tnonce = null,\n\ttype = JS,\n\tcrossOrigin = null,\n\treferrerPolicy = REFERRER_POLICY,\n\tnoModule = false,\n\tfetchPriority = 'auto',\n\tdataset = null,\n\tpolicy = 'trustedTypes' in globalThis ? globalThis.trustedTypes.defaultPolicy : null,\n\tevents: { capture, passive, once, signal, ...events } = {},\n\t...attrs\n} = {}) {\n\tconst script = createElement('script', {\n\t\tdataset,\n\t\tevents: { capture, passive, once, signal, ...events },\n\t\t...attrs,\n\t});\n\n\tscript.type = type;\n\tscript.noModule = noModule;\n\tscript.async = async;\n\tscript.defer = defer;\n\tscript.referrerPolicy = referrerPolicy;\n\tscript.fetchPriority = fetchPriority;\n\n\tif (typeof crossOrigin === 'string' && src.origin !== location.origin) {\n\t\tscript.crossOrigin = crossOrigin;\n\t}\n\n\tif (typeof integrity === 'string') {\n\t\tscript.integrity = integrity;\n\t}\n\n\tif (typeof nonce === 'string') {\n\t\tscript.nonce = nonce;\n\t}\n\n\tif (Array.isArray(blocking)) {\n\t\tscript.setAttribute('blocking', blocking.join(' '));\n\t} else if (typeof blocking === 'string') {\n\t\tscript.setAttribute('blocking', blocking);\n\t}\n\n\tsetProp(script, 'src', src, { policy });\n\n\treturn script;\n}\n\nexport function createImage(src, {\n\talt = '',\n\tid = null,\n\theight = undefined,\n\twidth = undefined,\n\tcrossOrigin = null,\n\t'@type': type,\n\t'@context': context,\n\titemprop = null,\n\titemtype = null,\n\titemscope = undefined,\n\tsizes = null,\n\tsrcset = null,\n\treferrerPolicy = REFERRER_POLICY,\n\tfetchPriority = 'auto',\n\tloading = 'eager',\n\tdecoding = 'async',\n\trole = null,\n\tslot = null,\n\tpart = [],\n\tclassList = [],\n\tdataset = null,\n\tstyles = null,\n\tanimation,\n\tevents: { capture, passive, once, signal, ...events } = {},\n\t...attrs\n} = {}) {\n\tif (! (src instanceof URL)) {\n\t\tsrc = new URL(src, document.baseURI);\n\t}\n\n\tconst img = createElement('img', {\n\t\tid, classList, dataset, slot, part, styles,\n\t\titemtype, itemprop, itemscope, '@type': type, '@context': context,\n\t\tevents: { capture, passive, once, signal, ...events }, animation,\n\t\t...attrs\n\t});\n\n\tif (Number.isSafeInteger(width)) {\n\t\timg.width = width;\n\t}\n\n\tif (Number.isSafeInteger(height)) {\n\t\timg.height = height;\n\t}\n\n\timg.alt = alt;\n\timg.referrerPolicy = referrerPolicy;\n\timg.loading = loading;\n\timg.decoding = decoding;\n\timg.fetchPriority = fetchPriority;\n\n\tif (typeof role === 'string') {\n\t\timg.role = role;\n\t}\n\n\tif (typeof crossOrigin === 'string' && location.origin !== src.origin) {\n\t\timg.crossOrigin = crossOrigin;\n\t}\n\n\tif (isObject(srcset)) {\n\t\timg.srcset = Object.entries(srcset).map(([size, src]) => `${src} ${size}`).join(', ');\n\t} else if (Array.isArray(srcset) && srcset.length !== 0) {\n\t\timg.srcset = srcset.join(', ');\n\t} else if (typeof srcset === 'string') {\n\t\timg.srcset = srcset;\n\t}\n\n\tif (Array.isArray(sizes) && sizes.length !== 0) {\n\t\timg.sizes = sizes.join(', ');\n\t} else if (typeof sizes === 'string') {\n\t\timg.sizes = sizes;\n\t}\n\n\tif (typeof src === 'string' && src.length !== 0) {\n\t\timg.src = src;\n\t} else if (src instanceof URL) {\n\t\timg.src = src.href;\n\t}\n\n\treturn img;\n}\n\nexport function createLink(href = null, {\n\trel = [],\n\ttype = null,\n\tas = null,\n\tblocking = null,\n\tcrossOrigin = 'anonymous',\n\treferrerPolicy = 'no-referrer',\n\tfetchPriority = 'auto',\n\tintegrity = null,\n\tnonce = null,\n\tmedia = 'all',\n\tdisabled = false,\n\tdataset = null,\n\ttitle = null,\n\tsizes = [],\n\tevents: { capture, passive, once, signal, ...events } = {},\n\t...rest\n}) {\n\tconst link = createElement('link', {\n\t\tdataset, ...rest,\n\t\tevents: { capture, passive, once, signal, ...events },\n\t});\n\n\tif (Array.isArray(rel)) {\n\t\tlink.relList.add(...rel);\n\t} else if (typeof rel === 'string') {\n\t\tlink.relList.add(rel);\n\t}\n\n\tif (typeof type === 'string') {\n\t\tlink.type = type;\n\t}\n\n\tif (typeof as === 'string') {\n\t\tlink.as = as;\n\t}\n\n\tif (typeof crossOrigin === 'string') {\n\t\tlink.crossOrigin = crossOrigin;\n\t}\n\n\tif (typeof referrerPolicy === 'string') {\n\t\tlink.referrerPolicy = referrerPolicy;\n\t}\n\n\tif (typeof fetchPriority === 'string') {\n\t\tlink.fetchPriority = fetchPriority;\n\t}\n\n\tif (typeof integrity === 'string') {\n\t\tlink.integrity = integrity;\n\t}\n\n\tif (typeof nonce === 'string') {\n\t\tlink.nonce = nonce;\n\t}\n\n\tif (typeof media === 'string') {\n\t\tlink.media = media;\n\t}\n\n\tif (Array.isArray(blocking)) {\n\t\tlink.setAttribute('blocking', blocking.join(' '));\n\t} else if (typeof blocking === 'string') {\n\t\tlink.setAttribute('blocking', blocking);\n\t}\n\n\tif (typeof href === 'string') {\n\t\tlink.href = href;\n\t}\n\n\tif (disabled) {\n\t\tlink.disabled = true;\n\t}\n\n\tif (typeof title === 'string') {\n\t\tlink.title = title;\n\t}\n\n\tif (Array.isArray(sizes) && sizes.length !== 0) {\n\t\tlink.sizes.add(...sizes);\n\t} else if (typeof sizes === 'string') {\n\t\tlink.sizes.add(sizes);\n\t}\n\n\treturn link;\n}\n\nexport function createIframe(src, {\n\tname = null,\n\tid = null,\n\twidth = null,\n\theight = null,\n\tsrcdoc = null,\n\tloading = 'eager',\n\tframeBorder = 0,\n\tfetchPriority = 'auto',\n\tsandbox = ['allow-scripts'],\n\tallow = [],\n\treferrerPolicy = REFERRER_POLICY,\n\tclassList = [],\n\tdataset = null,\n\tstyles = null,\n\tpart = [],\n\tslot = null,\n\ttitle = null,\n\tanimation,\n\tpolicy = 'trustedTypes' in globalThis ? globalThis.trustedTypes.defaultPolicy : undefined,\n\tevents: { capture, passive, once, signal, ...events } = {},\n\t...rest\n} = {}) {\n\tconst iframe = createElement('iframe', {\n\t\tid, classList, dataset, styles, part, slot, animation,\n\t\tevents: { capture, passive, once, signal, ...events },\n\t\t...rest\n\t});\n\n\tiframe.loading = loading;\n\tiframe.fetchPriority = fetchPriority;\n\tiframe.referrerPolicy = referrerPolicy;\n\tiframe.frameBorder = frameBorder.toString();\n\n\tif (typeof name === 'string') {\n\t\tiframe.name = name;\n\t}\n\n\tif (typeof title === 'string') {\n\t\tiframe.title = title;\n\t}\n\n\tif (Array.isArray(sandbox)) {\n\t\tiframe.sandbox.add(...sandbox);\n\t}\n\n\tif (typeof height === 'number' && ! Number.isNaN(height)) {\n\t\tiframe.height = height;\n\t}\n\n\tif (typeof width === 'number' && ! Number.isNaN(width)) {\n\t\tiframe.width = width;\n\t}\n\n\tif (Array.isArray(allow) && allow.length !== 0) {\n\t\tiframe.allow = allow.join('; ');\n\n\t\tif (allow.includes('fullscreen')) {\n\t\t\tiframe.allowFullscreen = true;\n\t\t}\n\t} else if (isObject(allow)) {\n\t\tconst quoted = ['self', 'none'];\n\n\t\tiframe.allow = Object.entries(allow).map(([key, val]) => {\n\t\t\tif (Array.isArray(val)) {\n\t\t\t\tconst vals = val.map(item => {\n\t\t\t\t\tif (quoted.includes(item)) {\n\t\t\t\t\t\treturn `'${item}'`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn item;\n\t\t\t\t\t}\n\t\t\t\t}).join('; ');\n\n\t\t\t\treturn `${key} ${vals}`;\n\t\t\t} else if (quoted.includes(val)) {\n\t\t\t\treturn `${key} '${val}'`;\n\t\t\t} else {\n\t\t\t\treturn `${key} ${val}`;\n\t\t\t}\n\t\t}).join('; ') + ';';\n\n\t\tif ('fullscreen' in allow) {\n\t\t\tiframe.allowFullscreen = true;\n\t\t}\n\t} else if (typeof allow === 'string') {\n\t\tiframe.allow = allow;\n\t}\n\n\tif ((typeof srcdoc === 'string' && srcdoc.length !== 0) || isHTML(srcdoc)) {\n\t\tsetProp(iframe, 'srcdoc', srcdoc, { policy });\n\t} else if (srcdoc instanceof Document) {\n\t\tsetProp(iframe, 'srcdoc'. srcdoc.documentElement.outerHTML.replace(/\\n/g, ''), { policy });\n\t}\n\n\tif (typeof src === 'string' || src instanceof URL || isScriptURL(src)) {\n\t\tsetProp(iframe, 'src', src, { policy });\n\t} else if (src instanceof Document) {\n\t\tsetProp(iframe, 'srcdoc'. src.documentElement.outerHTML.replace(/\\n/g, ''), { policy });\n\t}\n\n\treturn iframe;\n}\n\nexport function createOption(option) {\n\tif (isObject(option)) {\n\t\tconst { label, value, disabled = false, selected = false, options } = option;\n\n\t\tif (Array.isArray(options)) {\n\t\t\treturn createOptGroup(label, options);\n\t\t} else {\n\t\t\tconst opt = document.createElement('option');\n\t\t\topt.label = label;\n\t\t\topt.value = value;\n\t\t\topt.disabled = disabled;\n\t\t\topt.selected = selected;\n\t\t\treturn opt;\n\t\t}\n\t} else {\n\t\tconst opt = document.createElement('option');\n\t\topt.label = option;\n\t\topt.value = option;\n\t\treturn opt;\n\t}\n}\n\nexport function createOptGroup(label, options) {\n\tif (typeof label !== 'string') {\n\t\tthrow new TypeError('label must be a string');\n\t} else if (! Array.isArray(options)) {\n\t\tthrow new TypeError('options must be an array');\n\t} else {\n\t\tconst optgroup = document.createElement('optgroup');\n\t\toptgroup.label = label;\n\t\toptgroup.append(...options.map(createOption));\n\t\treturn optgroup;\n\t}\n}\n\nexport function createDatalist(id, items) {\n\tif (typeof id !== 'string') {\n\t\tthrow new TypeError('id must be a string');\n\t} else if (! Array.isArray(items) || items.length == 0) {\n\t\tthrow new TypeError('Items must be a non-empty array');\n\t} else {\n\t\tconst list = document.createElement('datalist');\n\t\tlist.id = id;\n\n\t\tlist.append(...items.map(createOption));\n\n\t\treturn list;\n\t}\n}\n\nexport function createInput(name, {\n\ttype = 'text',\n\trequired = false,\n\tdisabled = false,\n\treadOnly = false,\n\tmultiple = false,\n\tchecked = false,\n\taccept,\n\tid,\n\tclassList,\n\tlist,\n\tvalue,\n\tplaceholder,\n\tpattern,\n\tinputMode,\n\tmin = NaN,\n\tmax = NaN,\n\tstep = NaN,\n\tminLength = NaN,\n\tmaxLength = NaN,\n\tautocomplete,\n\tstyles,\n\tdataset,\n\tpart,\n\tslot,\n\tanimation,\n\tevents: { capture, passive, once, signal, ...events } = {},\n\t...attrs\n} = {}) {\n\tif (typeof name !== 'string') {\n\t\tthrow new TypeError('name must be a string');\n\t} else {\n\t\tconst input = createElement('input', {\n\t\t\tid, classList, dataset, styles, part, slot, animation,\n\t\t\tevents: { capture, passive, once, signal, ...events },\n\t\t\t...attrs\n\t\t});\n\n\t\tinput.name = name;\n\t\tinput.type = type;\n\t\tinput.required = required;\n\t\tinput.disabled = disabled;\n\t\tinput.readOnly = readOnly;\n\t\tinput.multiple = multiple;\n\t\tinput.checked = checked;\n\n\t\tif (typeof autocomplete === 'string') {\n\t\t\tinput.autocomplete = autocomplete;\n\t\t}\n\n\t\tif (typeof inputMode === 'string') {\n\t\t\tinput.inputMode = inputMode;\n\t\t}\n\n\t\tif (typeof list === 'string') {\n\t\t\tinput.setAttribute('list', list);\n\t\t}\n\n\t\tif (typeof placeholder === 'string') {\n\t\t\tinput.placeholder = placeholder;\n\t\t}\n\n\t\tif (typeof pattern === 'string') {\n\t\t\tinput.pattern = pattern;\n\t\t}\n\n\t\tif (! isNullish(min)) {\n\t\t\tinput.min = min;\n\t\t}\n\n\t\tif (! isNullish(max)) {\n\t\t\tinput.max = max;\n\t\t}\n\n\t\tif (Number.isSafeInteger(minLength) && minLength >= 0) {\n\t\t\tinput.minLength = minLength;\n\t\t}\n\n\t\tif (Number.isSafeInteger(maxLength) && maxLength > 0) {\n\t\t\tinput.maxLength = maxLength;\n\t\t}\n\n\t\tif (! isNullish(step)) {\n\t\t\tinput.step = step;\n\t\t}\n\n\t\tif (! isNullish(value)) {\n\t\t\tinput.value = value;\n\t\t}\n\n\t\tif (typeof accept === 'string') {\n\t\t\tinput.accept = accept;\n\t\t} else if (Array.isArray(accept)) {\n\t\t\tinput.accept = accept.join(',');\n\t\t}\n\n\t\treturn input;\n\t}\n}\n\nexport function createSelect(name, options = [], {\n\trequired = false,\n\tdisabled = false,\n\tmultiple = false,\n\tid,\n\tclassList,\n\tdataset,\n\tautocomplete,\n\tstyles,\n\tslot,\n\tpart,\n\tanimation,\n\tevents: { capture, passive, once, signal, ...events } = {},\n\t...attrs\n} = {}) {\n\tif (typeof name !== 'string') {\n\t\tthrow new TypeError('name must be a string');\n\t} else if (! Array.isArray(options)) {\n\t\tthrow new TypeError('options must be an array');\n\t} else {\n\t\tconst select = createElement('select', {\n\t\t\tid, classList, dataset, styles, part, slot, animation,\n\t\t\tevents: { capture, passive, once, signal, ...events },\n\t\t\t...attrs\n\t\t});\n\n\t\tselect.name = name;\n\t\tselect.multiple = multiple;\n\t\tselect.disabled = disabled;\n\t\tselect.required = required;\n\t\tselect.append(...options.map(createOption));\n\n\t\tif (typeof autocomplete === 'string') {\n\t\t\tselect.autocomplete = autocomplete;\n\t\t}\n\n\t\treturn select;\n\t}\n}\n\nexport async function showDialog({ text, html, children = [], classList = [], animation, signal, ...rest }) {\n\tconst { resolve, reject, promise } = getDeferred();\n\n\tif (signal instanceof AbortSignal && signal.aborted) {\n\t\treject(signal.reason);\n\t} else {\n\t\tconst closeContainer = createElement('div', {\n\t\t\tclassList: ['flex', 'space-evenly'],\n\t\t\tchildren: [\n\t\t\t\tcreateElement('button', {\n\t\t\t\t\ttype: 'button',\n\t\t\t\t\tclassList: ['btn', 'btn-reject'],\n\t\t\t\t\ttext: 'Close',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tsignal,\n\t\t\t\t\t\tclick: ({ target }) => target.closest('dialog').close(),\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\n\t\tconst dialog = createElement('dialog', {\n\t\t\ttext, html, children: [...children, closeContainer], classList, animation, ...rest,\n\t\t\tevents: {\n\t\t\t\tsignal,\n\t\t\t\tclose: ({ target }) => {\n\t\t\t\t\tresolve();\n\t\t\t\t\ttarget.remove();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tdialog.append();\n\n\t\tdocument.body.append(dialog);\n\t\tdialog.showModal();\n\n\t\tif (signal instanceof AbortSignal) {\n\t\t\tconst abortHandler = ({ target }) => {\n\t\t\t\treject(target.reason);\n\t\t\t\tdialog.close();\n\t\t\t};\n\n\t\t\tsignal.addEventListener('abort', abortHandler);\n\t\t\tdialog.addEventListener('close', () => signal.removeEventListener('abort', abortHandler));\n\t\t}\n\t}\n\n\tawait promise;\n}\n","/**\n * @copyright 2023 Chris Zuber <admin@kernvalley.us>\n */\nimport { JS } from './types.js';\nimport { createScript, createImage, createLink } from './elements.js';\nimport { getDeferred } from './promises.js';\nimport { getHTML } from './http.js';\nimport { callOnce } from './utility.js';\n\n/**\n * @deprecated\n */\nexport async function loadLink(...args) {\n\tconsole.warn('`loadLink()` is deprecated. Please us `createLink()` instead');\n\treturn createLink(...args);\n}\n\nexport function getTemplateLoader(url, {\n\tmode = 'cors',\n\tcredentials = 'omit',\n\tcache = 'default',\n\tredirect = 'follow',\n\treferrerPolicy = 'no-referrer',\n\tintegrity = undefined,\n\tpriority = 'auto',\n\tpolicy = 'trustedTypes' in globalThis ? trustedTypes.defaultPolicy : null,\n\tsanitizer,\n} = {}) {\n\tconst getTmp = callOnce(async ({ signal } = {}) => getHTML(url, {\n\t\tsignal, policy, sanitizer, cache, redirect, integrity, referrerPolicy,\n\t\tpriority, credentials, mode,\n\t}));\n\n\treturn ({ signal } = {}) => getTmp({ signal }).then(frag => frag.cloneNode(true));\n}\n\nexport async function preload(href, {\n\tas = 'fetch',\n\ttype = null,\n\tcrossOrigin = 'anonymous',\n\treferrerPolicy = 'no-referrer',\n\tfetchPriority = 'auto',\n\tmedia = null,\n\tintegrity = null,\n\tsignal,\n} = {}) {\n\tif (signal instanceof AbortSignal) {\n\t\tsignal.throwIfAborted();\n\t}\n\n\tconst link = createLink(href, {\n\t\trel: ['preload'], as, type, crossOrigin, referrerPolicy,\n\t\tfetchPriority, media, integrity,\n\t});\n\n\tdocument.head.append(link);\n\treturn link;\n}\n\nexport async function preconnect(href, {\n\tcrossOrigin = 'anonymous',\n\treferrerPolicy = 'no-referrer',\n\tsignal,\n} = {}) {\n\tif (signal instanceof AbortSignal) {\n\t\tsignal.throwIfAborted();\n\t}\n\n\tconst link = createLink(href, { rel: ['preconnect'], crossOrigin, referrerPolicy });\n\tdocument.head.append(link);\n\treturn link;\n}\n\nexport async function dnsPrefetch(href, {\n\tcrossOrigin = 'anonymous',\n\treferrerPolicy = 'no-referrer',\n\tsignal,\n} = {}) {\n\tif (signal instanceof AbortSignal) {\n\t\tsignal.throwIfAborted();\n\t}\n\n\tconst link = createLink(href, { rel: ['dsn-prefetch'], crossOrigin, referrerPolicy });\n\tdocument.head.append(link);\n\treturn link;\n}\n\nexport async function prerender(href, { signal } = {}) {\n\tif (signal instanceof AbortSignal) {\n\t\tsignal.throwIfAborted();\n\t}\n\n\tconst link = document.createElement('link');\n\tlink.relList.add('prerender');\n\tlink.href = href;\n\tdocument.head.append(link);\n\treturn link;\n}\n\nexport async function loadScript(src, {\n\tasync = true,\n\tdefer = false,\n\tblocking = null,\n\tnoModule = false,\n\ttype = JS,\n\tcrossOrigin = 'anonymous',\n\treferrerPolicy = 'no-referrer',\n\tintegrity = null,\n\tnonce = null,\n\tfetchPriority = 'auto',\n\tparent = document.head,\n\tpolicy = 'trustedTypes' in globalThis ? globalThis.trustedTypes.defaultPolicy : null,\n\tsignal,\n\tdata = {},\n} = {}) {\n\tconst { resolve, reject, promise } = getDeferred();\n\n\tif (signal instanceof AbortSignal && signal.aborted) {\n\t\treject(signal.reason);\n\t} else {\n\t\tconst controller = new AbortController();\n\t\tconst script = createScript(src, {\n\t\t\tasync, defer, noModule, type, crossOrigin, referrerPolicy, integrity,\n\t\t\tnonce, fetchPriority, policy, dataset: data, blocking,\n\t\t\tevents: {\n\t\t\t\tload: ({ target }) => {\n\t\t\t\t\tresolve(target);\n\t\t\t\t\tcontroller.abort();\n\t\t\t\t},\n\t\t\t\terror: ({ target }) => {\n\t\t\t\t\tconst err = new DOMException(`Error loading <script src=\"${target.src}\">`);\n\t\t\t\t\treject(err);\n\t\t\t\t\tcontroller.abort(err);\n\t\t\t\t},\n\t\t\t\tsignal: signal instanceof AbortSignal\n\t\t\t\t\t? AbortSignal.any([signal, controller.signal])\n\t\t\t\t\t: controller.signal,\n\t\t\t}\n\t\t});\n\n\t\tif (parent instanceof Element) {\n\t\t\tparent.append(script);\n\t\t} else {\n\t\t\tdocument.head.append(script);\n\t\t}\n\n\t\tif (signal instanceof AbortSignal) {\n\t\t\tsignal.addEventListener(\n\t\t\t\t'abort',\n\t\t\t\t({ target }) => {\n\t\t\t\t\treject(target.reason);\n\t\t\t\t\tcontroller.abort(target.reason);\n\n\t\t\t\t\tif (script.parentElement instanceof Element) {\n\t\t\t\t\t\tscript.remove();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{ once: true, signal: controller.signal });\n\t\t}\n\t}\n\n\treturn await promise;\n}\n\nexport async function loadStylesheet(href, {\n\trel = 'stylesheet',\n\tmedia = 'all',\n\tblocking = null,\n\tcrossOrigin = 'anonymous',\n\treferrerPolicy = 'no-referrer',\n\tintegrity = null,\n\tdisabled = false,\n\tfetchPriority = 'auto',\n\ttitle = null,\n\tnonce = null,\n\tparent = document.head,\n\tsignal,\n} = {}) {\n\tconst { resolve, reject, promise } = getDeferred();\n\n\tif (signal instanceof AbortSignal && signal.aborted) {\n\t\treject(signal.reason);\n\t} else {\n\t\tconst controller = new AbortController();\n\n\t\tconst link = await createLink(href, {\n\t\t\trel, media, crossOrigin, referrerPolicy, integrity, disabled, fetchPriority,\n\t\t\ttitle, nonce, blocking,\n\t\t\tevents: {\n\t\t\t\tload: ({ target }) => {\n\t\t\t\t\tresolve(target);\n\t\t\t\t\tcontroller.abort();\n\t\t\t\t},\n\t\t\t\terror: ({ target }) => {\n\t\t\t\t\tconst err = new DOMException(`Error loading <link href=\"${target.href}\">`);\n\t\t\t\t\treject(err);\n\t\t\t\t\tcontroller.abort(err);\n\t\t\t\t},\n\t\t\t\tsignal: signal instanceof AbortSignal\n\t\t\t\t\t? AbortSignal.any([signal, controller.signal])\n\t\t\t\t\t: controller.signal,\n\t\t\t}\n\t\t});\n\n\t\tif (signal instanceof AbortSignal) {\n\t\t\tsignal.addEventListener(\n\t\t\t\t'abort',\n\t\t\t\t({ target }) => {\n\t\t\t\t\treject(target.reason);\n\t\t\t\t\tcontroller.abort(target.reason);\n\n\t\t\t\t\tif (link.parentELement instanceof Element) {\n\t\t\t\t\t\tlink.disabled = true;\n\t\t\t\t\t\tlink.remove();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{ once: true, signal: controller.signal });\n\t\t}\n\n\t\tparent.append(link);\n\t}\n\n\treturn await promise;\n}\n\nexport async function loadImage(src, {\n\tloading = 'eager',\n\tdecoding = 'async',\n\tcrossOrigin = 'anonymous',\n\treferrerPolicy = 'no-referrer',\n\tfetchPriority = 'auto',\n\tsizes = null,\n\tsrcset = null,\n\theight = undefined,\n\twidth = undefined,\n\tslot = null,\n\tpart = [],\n\tclasses = [],\n\tclassList = [],\n\trole = 'img',\n\talt = '',\n\tsignal,\n} = {}) {\n\tif (signal instanceof AbortSignal) {\n\t\tsignal.throwIfAborted();\n\t}\n\n\tif (Array.isArray(classes) && classes.length !== 0) {\n\t\tconsole.warn('`classes` is deprecated. Please use `classList` instead.');\n\t}\n\n\tconst img = createImage(src, {\n\t\tloading, decoding, crossOrigin, referrerPolicy, sizes, srcset, height,\n\t\twidth, slot, part, classList: [...classList, ...classes], role, alt, fetchPriority,\n\t});\n\n\tif (img.loading !== 'lazy') {\n\t\tawait img.decode();\n\t}\n\n\treturn img;\n}\n","/**\n * @copyright 2021-2023 Chris Zuber <admin@kernvalley.us>\n */\nimport { loadScript } from './loader.js';\nexport const trustPolicies = ['goog#html'];\n\nif (! Array.isArray(window.dataLayer)) {\n\twindow.dataLayer = [];\n}\n\nexport function ga(...args) {\n\tif (window.ga instanceof Function) {\n\t\treturn window.ga(...args);\n\t}\n}\n\nexport async function ready(timeout = 2000) {\n\tawait new Promise((resolve, reject) => {\n\t\tif (! hasGa()) {\n\t\t\treject(new DOMException('Google Analytics script not loaded'));\n\t\t} else {\n\t\t\tconst id = setTimeout(() => reject(new DOMException('GA ready callback timed-out')), timeout);\n\n\t\t\tga(() => {\n\t\t\t\tclearTimeout(id);\n\t\t\t\tresolve();\n\t\t\t});\n\t\t}\n\t});\n}\n\nexport function getUTMParams(search = window.location.search) {\n\tconst params = new URLSearchParams(search);\n\treturn  {\n\t\tcampaign: params.get('utm_campaign'),\n\t\tcontent: params.get('utm_content'),\n\t\tmedium: params.get('utm_medium'),\n\t\tsource: params.get('utm_source'),\n\t\tterm: params.get('utm_term'),\n\t};\n}\n\nexport async function create(...args) {\n\tawait ready();\n\treturn ga('create', ...args);\n}\n\nexport async function remove() {\n\tawait ready();\n\treturn ga('remove');\n}\n\nexport async function get(prop, timeout = 150) {\n\treturn await getTracker(timeout).then(tracker => tracker.get(prop));\n}\n\nexport async function getTracker(timeout = 150) {\n\tif (hasGa()) {\n\t\treturn await new Promise(async (resolve, reject) => {\n\t\t\tconst id = setTimeout(() => reject(new DOMException('Timeout obtaining tracker')), timeout);\n\n\t\t\tga(tracker => {\n\t\t\t\tif (typeof tracker !== 'undefined') {\n\t\t\t\t\tclearTimeout(id);\n\t\t\t\t\tresolve(tracker);\n\t\t\t\t} else {\n\t\t\t\t\treject(new DOMException('Unable to obtain GA tracker'));\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t} else {\n\t\tnew DOMException('Google Analytics script not loaded');\n\t}\n}\n\nexport async function set(...args) {\n\tawait ready();\n\treturn ga('set', ...args);\n}\n\nexport async function require(...args) {\n\tawait ready();\n\treturn ga('require', ...args);\n}\n\nexport async function provide(...args) {\n\tawait ready();\n\treturn ga('provide', ...args);\n}\n\nexport async function location(url = window.location.href) {\n\treturn set('page', url);\n}\n\nexport async function pageView(page = window.location.pathname) {\n\treturn send({ hitType: 'pageview', page });\n}\n\nexport async function send({\n\teventCategory,\n\teventAction,\n\teventValue,\n\teventLabel,\n\thitType       = 'event',\n\ttransport     = 'beacon',\n} = {}) {\n\tawait new Promise(async(hitCallback, reject) => {\n\t\tif (hasGa()) {\n\t\t\tawait ready();\n\t\t\tga('send', { hitType, eventCategory, eventAction, eventLabel,\n\t\t\t\teventValue, transport, hitCallback });\n\t\t} else {\n\t\t\treject(new Error('ga has not been successfully initialized'));\n\t\t}\n\t});\n}\n\nexport function gtag() {\n\twindow.dataLayer.push(arguments);\n}\n\nexport function hasGa() {\n\treturn window.ga instanceof Function;\n}\n\nexport async function importGa(id, params = {}, { policy } = {}) {\n\tconst url = new URL('https://www.googletagmanager.com/gtag/js');\n\turl.searchParams.set('id', id);\n\tObject.entries(params).forEach(([k, v]) => url.searchParams.set(k, v));\n\n\tawait loadScript(url.href, { crossOrigin: 'use-credentials', policy, }).then(() => {\n\t\tgtag('js', new Date());\n\t\tgtag('config', id);\n\t\tcreate(id, 'auto');\n\t}).catch(console.error);\n\n\treturn { gtag, ga, send, get, set, ready, create, remove, require,\n\t\tlocation, pageView, getTracker, getUTMParams, hasGa };\n}\n\nexport function externalHandler() {\n\tif (hasGa()) {\n\t\tsend({\n\t\t\thitType: 'event',\n\t\t\teventCategory: 'outbound',\n\t\t\teventAction: 'click',\n\t\t\teventLabel: this.href,\n\t\t\ttransport: 'beacon',\n\t\t});\n\t}\n}\n\nexport function telHandler() {\n\tif (hasGa()) {\n\t\tsend({\n\t\t\thitType: 'event',\n\t\t\teventCategory: 'call',\n\t\t\teventLabel: this.href.replace('tel:', '').trim(),\n\t\t\ttransport: 'beacon',\n\t\t});\n\t}\n}\n\nexport function mailtoHandler() {\n\tif (hasGa()) {\n\t\tsend({\n\t\t\thitType: 'event',\n\t\t\teventCategory: 'email',\n\t\t\teventLabel: this.href.replace('mailto:', '').trim(),\n\t\t\ttransport: 'beacon',\n\t\t});\n\t}\n}\n\nexport function geoHandler() {\n\tif (hasGa()) {\n\t\tsend({\n\t\t\thitType: 'event',\n\t\t\teventCategory: 'geo',\n\t\t\teventLabel: this.href.replace('geo:', '').trim(),\n\t\t\ttransport: 'beacon',\n\t\t});\n\t}\n}\n\nexport function genericHandler() {\n\tif (hasGa()) {\n\t\tconst {\n\t\t\thitType = 'event', eventCategory = 'unknown', eventLabel = 'unknown',\n\t\t\ttransport = 'beacon',\n\t\t} = this.dataset;\n\t\tsend({ hitType, eventCategory, eventLabel, transport });\n\t}\n}\n","export const name = '@shgysk8zer0/components';\nexport const version = '0.0.1';\nexport const url = `https://unpkg.com/${name}@${version}/`;\n","import { url } from './consts.js';\n\nexport const isModule = ! (document.currentScript instanceof HTMLScriptElement);\nexport const meta = isModule\n\t? { url: import.meta.url, resolve: path => import.meta.resolve(path) }\n\t: { url, resolve: path => new URL(path, url).href };\n","/**\n * @copyright 2023 Chris Zuber <admin@kernvalley.us>\n */\nimport { getDeferred } from './promises.js';\n\nconst protectedData = new WeakMap();\n\nconst observer = new IntersectionObserver((entries, observer) => {\n\tentries.forEach(entry => {\n\t\tif (entry.isIntersecting) {\n\t\t\tconst { resolve } = protectedData.get(entry.target);\n\t\t\tprotectedData.delete(entry.target);\n\t\t\tresolve(entry);\n\t\t\tobserver.unobserve(entry.target);\n\t\t}\n\t});\n}, {\n\trootMargin: `${Math.min(250, Math.floor(screen.height * 0.3))}px`,\n});\n\nexport async function whenIntersecting(target, { signal, base = document } = {}) {\n\tconst { resolve, reject, promise } = getDeferred();\n\n\tif (signal instanceof AbortSignal && signal.aborted) {\n\t\treject(signal.reason);\n\t} else if (typeof target === 'string') {\n\t\twhenIntersecting(base.querySelector(target), { signal }).then(resolve).catch(reject);\n\t} else if (! (target instanceof Element)) {\n\t\treject(new TypeError('Non-elements can never intersect'));\n\t} else if (protectedData.has(target)) {\n\t\tprotectedData.get(target).promise.then(resolve).catch(reject);\n\n\t\tif (signal instanceof AbortSignal) {\n\t\t\tsignal.addEventListener('abort', ({ target: { reason }}) => {\n\t\t\t\treject(reason);\n\t\t\t}, { once: true });\n\t\t}\n\t} else {\n\t\tprotectedData.set(target, { resolve, reject, promise });\n\t\tobserver.observe(target);\n\n\t\tif (signal instanceof AbortSignal) {\n\t\t\tsignal.addEventListener('abort', ({ target: { reason }}) => {\n\t\t\t\tobserver.unobserve(target);\n\n\t\t\t\tif (protectedData.has(target)) {\n\t\t\t\t\tprotectedData.get(target).reject(reason);\n\t\t\t\t\tprotectedData.delete(target);\n\t\t\t\t}\n\t\t\t}, { once: true });\n\t\t}\n\t}\n\n\treturn promise;\n}\n","import { text, attr, when } from '@shgysk8zer0/kazoo/dom.js';\nimport { getHTML } from '@shgysk8zer0/kazoo/http.js';\nimport { getEvents as getAllEvents } from '@shgysk8zer0/kazoo/krv/events.js';\nimport { registerCustomElement } from '@shgysk8zer0/kazoo/custom-elements.js';\nimport { loadStylesheet } from '@shgysk8zer0/kazoo/loader.js';\nimport { hasGa, send } from '@shgysk8zer0/kazoo/google-analytics.js';\nimport { meta } from '../import.meta.js';\nimport { getURLResolver, callOnce, setUTMParams } from '@shgysk8zer0/kazoo/utility.js';\nimport { whenIntersecting } from '@shgysk8zer0/kazoo/intersect.js';\nimport { getString, setString, getInt, setInt } from '@shgysk8zer0/kazoo/attrs.js';\nimport { createPolicy } from '@shgysk8zer0/kazoo/trust.js';\n\nconst policy = createPolicy('krv-events#html', { createHTML: input => input });\nexport const trustPolicies = [policy.name];\nconst resolveURL = getURLResolver({ base: meta.url, path: './krv/' });\nconst getTemplate = callOnce(() => getHTML(resolveURL('events.html'), { policy }));\nconst getEvents = callOnce(() => getAllEvents());\nconst protectedData = new WeakMap();\n\nfunction utm(url, { campaign, content = 'krv-events-el', medium, source, term }) {\n\treturn setUTMParams(url, { campaign, content, medium, source, term }).href;\n}\n\nregisterCustomElement('krv-events', class HTMLKRVEventsElement extends HTMLElement {\n\tconstructor() {\n\t\tsuper();\n\t\tconst parent = this.attachShadow({ mode: 'closed' });\n\t\tconst internals = this.attachInternals();\n\n\t\tPromise.all([\n\t\t\tgetTemplate().then(frag => frag.cloneNode(true)),\n\t\t\tloadStylesheet(resolveURL('./events.css'), { parent }),\n\t\t\tthis.whenConnected,\n\t\t]).then(([frag]) => {\n\t\t\tinternals.role = 'document';\n\t\t\tinternals.ariaLabel = 'Kern Valley Events Calendar';\n\t\t\tconst link = frag.querySelector('.app-link');\n\t\t\tlink.target = this.target;\n\n\t\t\tif (this.hasAttribute('source')) {\n\t\t\t\tlink.href = utm(link.href, this);\n\t\t\t}\n\n\t\t\tparent.append(frag);\n\t\t\tprotectedData.set(this, { shadow: parent, internals });\n\t\t\tthis.dispatchEvent(new Event('ready'));\n\t\t});\n\t}\n\n\tget ready() {\n\t\tif (! protectedData.has(this)) {\n\t\t\treturn when(this, 'ready');\n\t\t} else {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t}\n\n\tget whenConnected() {\n\t\tif (this.isConnected) {\n\t\t\treturn Promise.resolve();\n\t\t} else {\n\t\t\treturn when(this, 'connected');\n\t\t}\n\t}\n\n\tasync connectedCallback() {\n\t\tthis.dispatchEvent(new Event('connected'));\n\n\t\tif (this.loading === 'lazy') {\n\t\t\tawait whenIntersecting(this);\n\t\t}\n\n\t\tthis.render();\n\t}\n\n\tasync render() {\n\t\tconst now = new Date().toISOString();\n\t\tconst [data] = await Promise.all([\n\t\t\tgetEvents(),\n\t\t\tthis.ready,\n\t\t]);\n\n\t\tconst tmp = protectedData.get(this).shadow.getElementById('event-template').content;\n\t\tconst { campaign, content, medium, source, term, target } = this;\n\n\t\tconst events = data.filter(({ endDate }) => endDate > now)\n\t\t\t.splice(0, this.count)\n\t\t\t.map(({ name, url, description, startDate, endDate, location }) => {\n\t\t\t\tconst base = tmp.cloneNode(true);\n\t\t\t\tconst container = document.createElement('div');\n\t\t\t\tconst start = new Date(startDate);\n\t\t\t\tconst end = new Date(endDate);\n\t\t\t\tconst controller = new AbortController();\n\n\t\t\t\tfunction handler() {\n\t\t\t\t\tif (hasGa()) {\n\t\t\t\t\t\tsend({\n\t\t\t\t\t\t\thitType: 'event',\n\t\t\t\t\t\t\teventCategory: 'krv-event',\n\t\t\t\t\t\t\teventLabel: this.querySelector('.event-name').textContent,\n\t\t\t\t\t\t\teventAction: 'open',\n\t\t\t\t\t\t\ttransport: 'beacon',\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontroller.abort();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcontainer.classList.add('event');\n\n\t\t\t\tattr('.event-url', { href: utm(url, { campaign, content, medium, source, term}), target }, { base }).forEach(a => {\n\t\t\t\t\ta.addEventListener('click', handler, { signal: controller.signal });\n\t\t\t\t});\n\n\t\t\t\ttext('.event-name', name, { base });\n\t\t\t\ttext('.event-description', description, { base });\n\t\t\t\ttext('.event-start-time', start.toLocaleString(), { base });\n\t\t\t\tattr('.event-start-time', { datetime: start.toISOString() }, { base });\n\t\t\t\ttext('.event-end-time', end.toLocaleString(), { base });\n\t\t\t\tattr('.event-end-time', { datetime: end.toISOString() }, { base });\n\n\t\t\t\tif (typeof location !== 'undefined') {\n\t\t\t\t\ttext('.event-location', location.name || location.address.addressLocality, { base });\n\t\t\t\t}\n\n\t\t\t\tcontainer.append(base);\n\t\t\t\treturn container;\n\t\t\t});\n\n\t\tif (events.length !== 0) {\n\t\t\tprotectedData.get(this).shadow.getElementById('events-list').replaceChildren(...events);\n\t\t}\n\t}\n\n\tget count() {\n\t\treturn getInt(this, 'count', { fallback: 5 });\n\t}\n\n\tset count(val) {\n\t\tsetInt(this, 'count', val);\n\t}\n\n\tget content() {\n\t\treturn getString(this, 'content', { fallback: 'krv-events' });\n\t}\n\n\tset content(val) {\n\t\tsetString(this, 'content', val);\n\t}\n\n\tget loading() {\n\t\treturn getString(this,'loading', { fallback: 'eager' });\n\t}\n\n\tset loading(val) {\n\t\tsetString(this, 'loading', val);\n\t}\n\n\tget medium() {\n\t\treturn getString(this, 'medium', { fallback: 'referral' });\n\t}\n\n\tset medium(val) {\n\t\tsetString(this, 'medium',val);\n\t}\n\n\tget source() {\n\t\treturn getString(this, 'source');\n\t}\n\n\tset source(val) {\n\t\tsetString(this, 'source', val);\n\t}\n\n\tget target() {\n\t\treturn getString(this, 'target', { fallback: '_self' });\n\t}\n\n\tset target(val) {\n\t\tsetString(this, 'target', val);\n\t}\n\n\tget theme() {\n\t\treturn getString(this, 'theme', { fallback: 'auto' });\n\t}\n\n\tset theme(val) {\n\t\tsetString(this, 'theme', val);\n\t}\n\n\tget term() {\n\t\treturn getString(this, 'term');\n\t}\n\n\tset term(val) {\n\t\tsetString(this, 'term', val);\n\t}\n\n\tattributeChangedCallback(name/*, oldVal, newVal*/) {\n\t\tswitch(name) {\n\t\t\tcase 'count':\n\t\t\t\tthis.render().catch(console.error);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error(`Unhandled attribute changed: ${name}`);\n\t\t}\n\t}\n\n\tstatic get observedAttributes() {\n\t\treturn ['count'];\n\t}\n});\n"],"names":["getDeferred","signal","deferred","promise","Promise","resolve","reject","EventTarget","throwIfAborted","Function","aborted","reason","addEventListener","target","once","Object","seal","between","min","val","max","isNumber","num","Number","isNaN","clamp","value","Math","setProp","el","prop","policy","tagName","property","supported","trustedTypes","getPropertyType","toLowerCase","createScript","createScriptURL","createHTML","setAttr","attr","elementNs","attribute","getAttributeType","setAttributeNs","setAttribute","setAttributeNS","globalThis","createPolicy","isTrustPolicy","TrustedTypePolicy","isHTML","input","isScriptURL","URL","isTrustedType","isScript","getDefaultPolicy","defaultPolicy","funcs","WeakMap","async","registerServiceWorker","source","scope","type","updateViaCache","navigator","serviceWorker","register","then","catch","TypeError","DOMException","isObject","thing","is","Array","isArray","isIterable","Symbol","iterator","isNullish","length","Date","getTime","callOnce","callback","thisArg","args","has","get","what","constructor","name","retVal","apply","this","err","delete","set","setURLParams","forURL","params","url","document","baseURI","HTMLFormElement","FormData","URLSearchParams","fromEntries","entries","forEach","k","v","searchParams","toString","setUTMParams","utm_source","medium","utm_medium","content","utm_content","campaign","utm_campaign","term","utm_term","documentElement","dataset","ready","update","customElements","whenDefined","body","requireInteraction","actions","title","action","close","location","reload","reloadOnUpdate","console","error","features","createElement","eventFeatures","nativeSignal","AbortController","prototype","hasOwnProperty","passive","capture","options","removeEventListener","getEventFeatures","addListener","targets","events","query","of","event","listen","signalAborted","finally","window","TEXT","HTML","props","namespace","Element","p","removeAttribute","removeAttributeNS","toggleAttribute","toISOString","href","JSON","stringify","setInt","MIN_SAFE_INTEGER","MAX_SAFE_INTEGER","isInteger","parseInt","getString","fallback","hasAttribute","getAttribute","setString","minLength","maxLength","Infinity","pattern","RegExp","test","str","readyStates","readyStateIndex","state","readyState","indexOf","base","matches","from","querySelectorAll","push","each","items","item","text","textContent","when","controller","AbortSignal","abort","ev","cb","on","whenReadyState","stateIndex","settled","parse","asFrag","sanitizer","undefined","parser","DOMParser","tmp","innerHTML","sanitize","parseAsFragment","parseFromString","symbols","resp","HTTPException","Error","Response","message","cause","super","status","statusText","defineProperty","configurable","writable","enumerable","json","bodyUsed","headers","ok","redirected","toJSON","handleResponse","handleError","fetch","opts","Request","race","errorMessage","getHTTPCSP","method","directives","trim","split","filter","map","directive","key","rest","part","getMetaCSP","meta","head","querySelector","HTMLMetaElement","GET","mode","cache","credentials","redirect","priority","referrerPolicy","Headers","integrity","keepalive","timeout","getHTML","Accept","TYPES.HTML","html","TYPES.TEXT","getText","getLink","link","HTMLLinkElement","crossOrigin","csp","getEvents","getJSON","tag","context","identifier","itemtype","itemprop","itemscope","itemref","itemid","id","classList","hidden","accessKey","slot","children","styles","aria","animation","keyframes","duration","delay","endDelay","easing","direction","fill","iterations","iterationStart","composite","iterationComposite","pseudoElement","attrs","add","data","style","setProperty","removeProperty","css","Sanitizer","setHTML","append","join","accesskey","setAria","animate","loadStylesheet","rel","media","blocking","disabled","fetchPriority","nonce","parent","as","sizes","relList","createLink","load","any","parentELement","remove","ga","send","eventCategory","eventAction","eventValue","eventLabel","hitType","transport","hitCallback","hasGa","setTimeout","clearTimeout","dataLayer","currentScript","HTMLScriptElement","src","path","protectedData","observer","IntersectionObserver","entry","isIntersecting","unobserve","rootMargin","floor","screen","height","whenIntersecting","observe","freeze","trustPolicies","resolveURL","getURLResolver","getTemplate","getAllEvents","utm","cls","tags","every","isDefined","warn","define","registerCustomElement","HTMLElement","attachShadow","internals","attachInternals","all","frag","cloneNode","whenConnected","role","ariaLabel","shadow","dispatchEvent","Event","isConnected","loading","render","now","getElementById","endDate","splice","count","description","startDate","container","start","end","handler","a","toLocaleString","datetime","address","addressLocality","replaceChildren","NaN","getInt","theme","attributeChangedCallback","observedAttributes"],"mappings":"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"}